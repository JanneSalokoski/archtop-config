uPe.prototype.Ooa=W(1466,function(){return[]});uPe.prototype.Eoa=W(1465,m("Vastaa palautteeseen"));zX.prototype.pJ=W(1464,m(10));SX.prototype.pJ=W(1463,g("Pa"));VX.prototype.pJ=W(1462,g("D"));hVe.prototype.pJ=W(1461,m(10));SHe.prototype.yaa=W(1457,m(null));uPe.prototype.yaa=W(1456,g("F"));function tAf(a){var b=La();M(a,3,b)}
function uAf(a,b,c){var d=bj(a.C,YV,1),e=new YV;M(e,1,b);M(e,2,c);M(e,4,0);tAf(e);d.push(e);rd(d,function(f,h){return(h.Bi()||0)-(f.Bi()||0)});nd(d,void 0,function(f){return K(f,1)+", "+f.ib()});ej(a.C,1,md(d,0,a.R));rFd(a)}function vAf(a){return a.D["ritz-DataPrepSuggestionsSidepaneCount"]}
function wAf(a){var b=a.If,c=a.Efa,d=a.Hfa,e=a.Ffa,f=a.Cfa;a='<div class="'+T("waffle-assistant-popup-suggestion-text")+'">';b='Datan poistoehdotuksia saatavilla v\u00e4lille <span class="'+(T("waffle-inline-assistant-rec-range")+'">'+(R(b)+"</span>"));a=a+b+"<ul>";0<f&&(a+="<li>",b=HT(new uA("{NUM_ANOMALIES_1,plural, =1{{START_BOLD}{NUM_ANOMALIES_2}{END_BOLD}\u00a0poikkeama}other{{START_BOLD}{NUM_ANOMALIES_2}{END_BOLD}\u00a0poikkeamaa}}"),{NUM_ANOMALIES_1:f,START_BOLD:"<b>",NUM_ANOMALIES_2:R(f),
END_BOLD:"</b>"}),a=a+b+"</li>");0<e&&(a+="<li>",e=HT(new uA("{NUM_REMOVE_DUPLICATE_SUGGESTIONS_1,plural, =1{{START_BOLD}{NUM_REMOVE_DUPLICATE_SUGGESTIONS_2}{END_BOLD}\u00a0rivin kopio}other{{START_BOLD}{NUM_REMOVE_DUPLICATE_SUGGESTIONS_2}{END_BOLD}\u00a0rivin kopiota}}"),{NUM_REMOVE_DUPLICATE_SUGGESTIONS_1:e,START_BOLD:"<b>",NUM_REMOVE_DUPLICATE_SUGGESTIONS_2:R(e),END_BOLD:"</b>"}),a+=e,a+="</li>");0<c&&(a+="<li>",c=HT(new uA("{NUM_NF_SUGGESTIONS_1,plural, =1{{START_BOLD}{NUM_NF_SUGGESTIONS_2}{END_BOLD}\u00a0sarakkeen muotoehdotus}other{{START_BOLD}{NUM_NF_SUGGESTIONS_2}{END_BOLD}\u00a0sarakkeen muotoehdotusta}}"),
{NUM_NF_SUGGESTIONS_1:c,START_BOLD:"<b>",NUM_NF_SUGGESTIONS_2:R(c),END_BOLD:"</b>"}),a+=c,a+="</li>");0<d&&(a+="<li>",d=HT(new uA("{NUM_TRIM_WS_SUGGESTIONS_1,plural, =1{{START_BOLD}{NUM_TRIM_WS_SUGGESTIONS_2}{END_BOLD}\u00a0v\u00e4li, jossa ylim\u00e4\u00e4r\u00e4inen tyhj\u00e4}other{{START_BOLD}{NUM_TRIM_WS_SUGGESTIONS_2}{END_BOLD}\u00a0v\u00e4li\u00e4, joissa ylim\u00e4\u00e4r\u00e4inen tyhj\u00e4}}"),{NUM_TRIM_WS_SUGGESTIONS_1:d,START_BOLD:"<b>",NUM_TRIM_WS_SUGGESTIONS_2:R(d),END_BOLD:"</b>"}),
a+=d,a+="</li>");a+="</ul></div>";return S(a)}function xAf(a){var b=a.If,c=a.cVa;a='<div class="'+T("waffle-assistant-popup-suggestion-text")+'">';b=R(c)+('\u00a0datan poistoehdotusta saatavilla alueelle <span class="'+(T("waffle-inline-assistant-rec-range")+'">'+(R(b)+"</span>")));return S(a+b+"</div>")}
function yAf(a,b,c){b=c||b;c=a.If;var d=a.Efa,e=a.Hfa,f=a.Ffa,h=a.Cfa;a=a.d$b;var k='<div class="'+T("waffle-assistant-floating-popup")+'"><div class="'+T("waffle-assistant-popup-logo")+'" aria-label="';k+=Cw("Datan poistoehdotukset");k+='">'+R(jB({icon:"docs-icon-img docs-icon-explore-green"},b))+'</div><div class="'+T("waffle-assistant-popup-suggestion-text-container")+'">'+(a?wAf({If:c,Efa:d,Hfa:e,Ffa:f,Cfa:h},b):xAf({If:c,cVa:d+e+f+h},b))+'</div><div class="'+T("waffle-assistant-popup-button-row")+
'">';k+=R(Nz({ad:"waffle-assistant-popup-button waffle-assistant-popup-button-dismiss",content:"Hylk\u00e4\u00e4",id:"waffle-assistant-popup-button-dismiss",style:0},b));k+=R(Nz({ad:"waffle-assistant-popup-button waffle-assistant-popup-button-review",content:"Tarkista",id:"waffle-assistant-popup-button-review",style:2},b));return S(k+"</div></div>")}
function zAf(a,b){a.D=0;a.F=0;a.C=0;b=ia(b);for(var c=b.next();!c.done;c=b.next())switch(c=c.value,D(c,1)){case 7:a.D++;break;case 8:a.F++;break;case 9:c=D(c,16),c=jg(c,5),a.C+=c.length}}function AAf(a){var b=new Ej;for(d in K0b){var c=new QV;switch(K0b[d]){case 7:M(c,1,1);M(c,2,a.D);break;case 8:M(c,1,2);M(c,2,a.F);break;case 9:M(c,1,4);M(c,2,a.C);break;default:continue}fj(b,25,c,QV,void 0)}var d=new QV;M(d,1,3);M(d,2,a.H);fj(b,25,d,QV,void 0);return Cy(By(xy(new wy,76),b))}
function BAf(a,b,c,d,e,f){Q.call(this,f);var h=this;this.ma=a;this.J=c;this.C=this.F=this.D=-1;zAf(this,d);this.H=e;this.L=yB(new xB);this.va(this.L);this.R=new Gy(void 0,Ey.getInstance(),this.qa());this.Ga(this.R);Jz(this.L,this.R,gob,void 0,void 0,function(){return AAf(h)});this.O=new Gy(void 0,Ey.getInstance(),this.qa());this.Ga(this.O);Jz(this.L,this.O,fob,void 0,void 0,function(){return AAf(h)});this.V=new PW(b,"waffle-assistant-highlight-styled-border","waffle-assistant-highlight-styled-rect");
this.va(this.V)}u(BAf,Q);p=BAf.prototype;p.Ca=function(){var a=tN(this.J.rect);a=Sx(yAf,{If:a,Efa:this.D,Hfa:this.F,Ffa:this.C,Cfa:this.H,d$b:Ic(z(),"feadpdp")});this.jb(a)};p.Ia=function(){Q.prototype.Ia.call(this);this.R.Va(this.Fa("waffle-assistant-popup-button-review"));this.O.Va(this.Fa("waffle-assistant-popup-button-dismiss"));var a=this.La();this.getHandler().listen(a,"mouseenter",this.Y_b).listen(a,"mouseleave",this.Z_b);a={};yA(this.ma,(a.Fc=!0,a));RK("Assistantin ehdotusikkuna n\u00e4kyviss\u00e4.")};
p.Ja=function(){Q.prototype.Ja.call(this);var a={};yA(this.ma,(a.Fc=!1,a));RK("Assistantin ehdotusikkuna piilotettu.")};p.Y_b=function(){SW(this.V,this.J)};p.Z_b=function(){zW(this.V)};function CAf(a,b,c,d,e,f){if(a.fc&&!a.fc.isDisposed())return a.fc;var h=Ko(a.qa(),a.Ka.ib()+"-grid-table-container");a.fc=new BAf(c,b,d,e,f,a.gb);a.Ga(a.fc);a.fc.render(h);return a.fc}function DAf(a){this.we=Rm(a,-1,0)}u(DAf,Vm);DAf.prototype.hasType=function(){return Xm(this,1)};
DAf.prototype.getType=function(){return Um(this.we,1,0,Qm)};function EAf(a,b){var c=Xm(a,1)?Zm(a,1):Number.MIN_VALUE;a=Xm(a,2)?Zm(a,2):Number.MAX_VALUE;var d=Xm(b,1)?Zm(b,1):Number.MIN_VALUE;b=Xm(b,2)?Zm(b,2):Number.MAX_VALUE;return b>c&&a>d||c==d&&a==b}function FAf(a){a=a.toProto();"string"!==typeof a&&(a=sPb(a,uH));return Wm(dn,a)}
function GAf(a){var b=a.Q0b,c=a.V0b,d=a.P0b,e=a.If,f=a.J0b;a='<div tabindex=0 class="'+T("waffle-assistant-popup-suggestion")+'"><div class="'+T("waffle-assistant-card-checkbox")+'"></div><div class="'+T("waffle-assistant-card-feedback")+'"></div><div class="'+T("waffle-assistant-card-text")+'">';yw(c,b)?(b='Muuta <span class="'+(T("waffle-inline-assistant-rec-range")+'">'+(R(e)+('</span> numeromuotoon <span class="'+(T("waffle-inline-assistant-rec-detail")+'">'+(R(b)+(" ("+(R(d)+")</span>"))))))),
a+=b):yw(c,"UNKNOWN")?(b='Muuta <span class="'+(T("waffle-inline-assistant-rec-range")+'">'+(R(e)+('</span> numeromuotoon <span class="'+(T("waffle-inline-assistant-rec-detail")+'">'+(R(b)+" (</span>)"))))),a+=b):(b='Muuta <span class="'+(T("waffle-inline-assistant-rec-range")+'">'+(R(e)+('</span> (nyt <span class="'+(T("waffle-inline-assistant-rec-detail")+'">'+(R(c)+('</span>) numeromuotoon <span class="'+(T("waffle-inline-assistant-rec-detail")+'">'+(R(b)+"</span>")))))))),a+=b);1<f&&(f=' (<span class="'+
(T("waffle-assistant-popup-num-patterns")+'">'+(R(f)+"</span>\u00a0eri numeromuotoa havaittiin.)")),a+=f);return S(a+"</div></div>")}
function HAf(a){var b=a.column,c=a.Y_;a='<div tabindex=0 class="'+T("waffle-assistant-popup-suggestion")+'"><div class="'+T("waffle-assistant-card-checkbox")+'"></div><div class="'+T("waffle-assistant-card-feedback")+'"></div><div class="'+T("waffle-assistant-card-text")+'">';b='K\u00e4yt\u00e4 tyyppi\u00e4 <span class="'+(T("waffle-inline-assistant-rec-detail")+'">'+(R(c)+('</span> sarakkeessa <span class="'+(T("waffle-inline-assistant-rec-range")+'">'+(R(b)+"</span>")))));return S(a+b+"</div></div>")}
function IAf(a){var b=a.O0b,c=a.If,d=a.N6a,e=a.bKb,f=a.G0b;a='<div tabindex=0 class="'+T("waffle-assistant-popup-suggestion")+'"><div class="'+T("waffle-assistant-card-checkbox")+'"></div><div class="'+T("waffle-assistant-card-feedback")+'"></div><div class="'+T("waffle-assistant-card-text")+'">';d?e?(b='Muuta v\u00e4li\u00e4 <span class="'+(T("waffle-inline-assistant-rec-range")+'">'+(R(c)+('</span> poistamalla <span class="'+(T("waffle-inline-assistant-rec-detail")+'">'+(R(b)+('\u00a0tyhj\u00e4\u00e4</span> <span class="'+
(T("waffle-inline-assistant-rec-detail")+'">'+(R(f)+"</span> solun lopusta")))))))),a+=b):(b=HT(new uA("{NUM_WHITESPACES_1,plural, =1{Muuta v\u00e4li\u00e4 {START_SPAN_1}{RANGE}{END_SPAN} poistamalla {START_SPAN_2}{NUM_WHITESPACES_2}\u00a0tyhj\u00e4{END_SPAN} lopusta}other{Muuta v\u00e4li\u00e4 {START_SPAN_3}{RANGE}{END_SPAN} poistamalla {START_SPAN_4}{NUM_WHITESPACES_2}\u00a0tyhj\u00e4\u00e4{END_SPAN} lopusta}}"),{NUM_WHITESPACES_1:b,START_SPAN_1:'<span class="'+T("waffle-inline-assistant-rec-range")+
'">',RANGE:R(c),END_SPAN:"</span>",START_SPAN_2:'<span class="'+T("waffle-inline-assistant-rec-detail")+'">',NUM_WHITESPACES_2:R(b),START_SPAN_3:'<span class="'+T("waffle-inline-assistant-rec-range")+'">',START_SPAN_4:'<span class="'+T("waffle-inline-assistant-rec-detail")+'">'}),a+=b):e?(b='Muuta v\u00e4li\u00e4 <span class="'+(T("waffle-inline-assistant-rec-range")+'">'+(R(c)+('</span> poistamalla <span class="'+(T("waffle-inline-assistant-rec-detail")+'">'+(R(b)+('</span>\u00a0tyhj\u00e4\u00e4 <span class="'+
(T("waffle-inline-assistant-rec-detail")+'">'+(R(f)+"</span>\u00a0solusta")))))))),a+=b):(b=HT(new uA("{NUM_WHITESPACES_1,plural, =1{Muuta v\u00e4li\u00e4 {START_SPAN_1}{RANGE}{END_SPAN} poistamalla {START_SPAN_2}{NUM_WHITESPACES_2}{END_SPAN}\u00a0tyhj\u00e4}other{Muuta v\u00e4li\u00e4 {START_SPAN_3}{RANGE}{END_SPAN} poistamalla {START_SPAN_4}{NUM_WHITESPACES_2}{END_SPAN}\u00a0tyhj\u00e4\u00e4}}"),{NUM_WHITESPACES_1:b,START_SPAN_1:'<span class="'+T("waffle-inline-assistant-rec-range")+'">',RANGE:R(c),
END_SPAN:"</span>",START_SPAN_2:'<span class="'+T("waffle-inline-assistant-rec-detail")+'">',NUM_WHITESPACES_2:R(b),START_SPAN_3:'<span class="'+T("waffle-inline-assistant-rec-range")+'">',START_SPAN_4:'<span class="'+T("waffle-inline-assistant-rec-detail")+'">'}),a+=b);return S(a+"</div></div>")}
function JAf(a,b,c){b=c||b;wa(a.vL);var d=a.vL;var e=a.Y_;a=a.p8a;c='<div tabindex=0 class="'+T("waffle-assistant-popup-suggestion")+'"><div class="'+T("waffle-assistant-card-checkbox")+" "+T("waffle-assistant-card-checkbox-disabled")+'"></div><div class="'+T("waffle-assistant-card-feedback")+'"></div><div class="'+T("waffle-assistant-card-text")+'">';if(1==d.length)e='Muuta solu <span class="'+(T("waffle-inline-assistant-rec-range")+'">'+(R(d[0])+('</span> vastaamaan havaittua saraketyyppi\u00e4 <span class="'+
(T("waffle-inline-assistant-rec-detail")+'">'+(R(e)+"</span>"))))),c+=e;else if(1<d.length&&3>=d.length){for(var f=d[0],h=Math.max(0,Math.ceil(d.length-1-1)),k=0;k<h;k++)f+=", "+d[1+k];e='Muuta solut <span class="'+(T("waffle-inline-assistant-rec-range")+'">'+(R(f)+('</span> ja <span class="'+(T("waffle-inline-assistant-rec-range")+'">'+(R(d[d.length-1])+(' </span>vastaamaan havaittua saraketyyppi\u00e4 <span class="'+(T("waffle-inline-assistant-rec-detail")+'">'+(R(e)+"</span>"))))))));c+=e}else f=
d[0]+", "+d[1]+", "+d[2]+",",d=""+(d.length-3),e=HT(new uA("{NUM_OTHER_CELLS_1,plural, =1{Muuta {START_SPAN_1}{NEXT_THREE_CELLS}{END_SPAN} ja {START_SPAN_2}{NUM_OTHER_CELLS_2}{END_SPAN}\u00a0muu solu vastaamaan havaittua saraketyyppi\u00e4 {START_SPAN_3}{COLUMN_TYPE}{END_SPAN}}other{Muuta {START_SPAN_4}{NEXT_THREE_CELLS}{END_SPAN} ja {START_SPAN_5}{NUM_OTHER_CELLS_2}{END_SPAN}\u00a0muuta solua vastaamaan havaittua saraketyyppi\u00e4 {START_SPAN_6}{COLUMN_TYPE}{END_SPAN}}}"),{NUM_OTHER_CELLS_1:d,START_SPAN_1:'<span class="'+
T("waffle-inline-assistant-rec-range")+'">',NEXT_THREE_CELLS:R(f),END_SPAN:"</span>",START_SPAN_2:'<span class="'+T("waffle-inline-assistant-rec-range")+'">',NUM_OTHER_CELLS_2:R(d),START_SPAN_3:'<span class="'+T("waffle-inline-assistant-rec-detail")+'">',COLUMN_TYPE:R(e),START_SPAN_4:'<span class="'+T("waffle-inline-assistant-rec-range")+'">',START_SPAN_5:'<span class="'+T("waffle-inline-assistant-rec-range")+'">',START_SPAN_6:'<span class="'+T("waffle-inline-assistant-rec-detail")+'">'}),c+=e;c+=
'</div><div class="'+T("waffle-assistant-form")+'">';c+='<div class="'+T("waffle-assistant-input-edit-icon")+'">'+R(jB({icon:"docs-icon-img docs-icon-edit-outline-20"},b))+'</div><input type="text" class="'+T("jfk-textinput")+'" placeholder="'+T("Uusi solun arvo")+'" aria-label="'+T("Uusi solun arvo")+'" value="'+T(a)+'"/></div></div>';return S(c)}
function KAf(a){var b='<div class="waffle-inline-assistant-sidebar-survey-container">';a='<a href="'+T(Dw(a.link))+'" class="'+T("waffle-inline-assistant-sidebar-survey-link")+'" target="_blank">Vastaa t\u00e4t\u00e4 ominaisuutta koskevaan lyhyeen kyselyyn</a>';return S(b+a+"</div>")}
function LAf(){return S('<div class="waffle-inline-assistant-sidebar-intro">N\u00e4et ehdotukset my\u00f6s yl\u00e4palkin valikosta Data -> Poistoehdotukset.<br><br>Vinkki: Voit esikatsella muutoksia taulukossa viem\u00e4ll\u00e4 hiiren ehdotusten p\u00e4\u00e4lle</div>')}
function MAf(a){wa(a.JXa);var b=a.JXa;wa(a.IXa);var c=a.IXa;a='<div tabindex=0 class="'+T("waffle-assistant-popup-suggestion")+'"><div class="'+T("waffle-assistant-card-checkbox")+'"></div><div class="'+T("waffle-assistant-card-text")+'"><div class="'+T("waffle-assistant-card-feedback")+'"></div>';var d=""+(b[0]+1),e=""+(c[c.length-1]+1);if(1<b.length)d='Taulukon <span class="'+(T("waffle-inline-assistant-rec-range")+'">'+(R(b.length)+('</span>\u00a0rivill\u00e4 on <span class="'+(T("waffle-inline-assistant-rec-range-red")+
'">kopiot</span>. Poista rivien kopiot')))),a+=d;else if(1==c.length)d='Poista rivi <span class="'+(T("waffle-inline-assistant-rec-range-red")+'">'+(R(e)+('</span>, rivin <span class="'+(T("waffle-inline-assistant-rec-range")+'">'+(R(d)+"</span> kopio"))))),a+=d;else if(1<c.length&&6>=c.length){b=""+(c[0]+1);for(var f=Math.max(0,Math.ceil(c.length-1-1)),h=0;h<f;h++)b+=", "+(c[1+h]+1);d='Poista rivit <span class="'+(T("waffle-inline-assistant-rec-range-red")+'">'+(R(b)+('</span> ja <span class="'+
(T("waffle-inline-assistant-rec-range-red")+'">'+(R(e)+('</span>, rivin <span class="'+(T("waffle-inline-assistant-rec-range")+'">'+(R(d)+"</span> kopiot"))))))));a+=d}else{e=""+(c[0]+1);for(b=0;2>b;b++)e+=", "+(c[1+b]+1);c=""+(c.length-4);d='Poista rivit <span class="'+(T("waffle-inline-assistant-rec-range-red")+'">'+(R(e)+('</span> ja <span class="'+(T("waffle-inline-assistant-rec-range-red")+'">'+(R(c)+('</span>\u00a0muuta rivi\u00e4, rivin\u00a0<span class="'+(T("waffle-inline-assistant-rec-range")+
'">'+(R(d)+"</span> kopiot"))))))));a+=d}return S(a+"</div></div>")}
function NAf(a,b,c){b=c||b;c=a.n8a;var d=a.K0b;a='<div class="'+T("waffle-inline-assistant-sidebar-category-container")+'"><div class="'+T("waffle-inline-assistant-sidebar-category-header")+'"><div class="'+T("waffle-inline-assistant-sidebar-category-check-all")+'">';a=a+'Valitse kaikki</div><div class="'+(T("waffle-inline-assistant-sidebar-category-label")+'">'+R(c)+"</div></div>");yw(c,"Column types")?(a+='<div class="'+T("waffle-inline-assistant-sidebar-category-description")+'">',a+="K\u00e4yt\u00e4 saraketyyppej\u00e4 kuvaamaan sarakkeiden sis\u00e4lt\u00e4m\u00e4\u00e4 dataa ja est\u00e4m\u00e4\u00e4n virheellisi\u00e4 sy\u00f6tteit\u00e4</div>"):
yw(c,"Trim whitespace")&&(a+='<div class="'+T("waffle-inline-assistant-sidebar-category-description")+'">',a+="Poista ylim\u00e4\u00e4r\u00e4iset tyhj\u00e4tilamerkit solun sis\u00e4ll\u00f6n alusta, keskelt\u00e4 tai lopusta.</div>");a+='<div class="'+T("waffle-inline-assistant-sidebar-category-cards")+'"></div><div class="'+T("waffle-inline-assistant-sidebar-category-show-more-button docs-material")+'">'+R(jB({icon:"docs-icon-img docs-icon-chevron-down-24"},b));b=HT(new uA("{NUM_OVERFLOW_CARDS_1,plural, =1{N\u00e4yt\u00e4 {NUM_OVERFLOW_CARDS_2}\u00a0muu ehdotus}other{N\u00e4yt\u00e4 {NUM_OVERFLOW_CARDS_2}\u00a0muuta ehdotusta}}"),
{NUM_OVERFLOW_CARDS_1:d,NUM_OVERFLOW_CARDS_2:R(d)});return S(a+b+"</div></div>")}function OAf(a,b,c){var d=a.Yc(),e=a.Xc();switch(b){case 0:d=Math.min(d,a.Ac()+c);break;case 1:e=Math.min(e,a.yc()+c)}return tPb(a.ib(),a.Ac(),a.yc(),d,e)}
function PAf(){return S('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content"><div class="waffle-assistant-answercard-interpret-content"><div class="waffle-assistant-answercard-interpret"></div></div><div class="waffle-assistant-answercard-answer-content"><div class="waffle-assistant-answercard-pivot-content"></div></div></div></div>')}
function QAf(a,b,c){b=c||b;return S(R(Nz({ad:"waffle-assistant-insert-pivottable-button waffle-assistant-readonly-hidden",content:Aw(""+R(jB({icon:"docs-icon-img docs-icon-insert-pivot-table"},b))),style:4},b))+'<div class="waffle-assistant-button-separator waffle-assistant-readonly-hidden"></div>'+R(Nz({ad:"waffle-assistant-zoom-button",content:Aw(""+R(jB({icon:"docs-icon-img docs-icon-zoom-in"},b))),style:4},b)))}
function RAf(a,b,c,d,e,f,h){jY.call(this,a,b,c,new VTe,"regular",e,f,h);this.Pa=d;a=a.C;c=new DP(c,!0,!0);this.R=new jVe(a,new CQe(c),b);this.R.Ba=this.D;b=new FK;E(b,5,!0);E(b,12,Clb);this.Qa=new dWe(b);this.C=this.xa=null;this.ma=[]}u(RAf,jY);p=RAf.prototype;p.Ia=function(){jY.prototype.Ia.call(this);this.getHandler().listen(this.Pa,"selectionChange",this.eRb)};p.zSa=function(a){this.R.L=a;this.V.lD(a)};p.Qca=function(){jY.prototype.Qca.call(this);SAf(this)};
p.Cz=function(){var a=this.J;return GJ(a.C)?gHe(a)?jY.prototype.Cz.call(this):!1:!1};p.WHa=function(){if(this.C){var a=JT(this.C.getTableRange());a=mn(a);return oOe(a,CJ(this.J.C))}return null};p.Vya=function(){if(this.C){var a=JT(this.C.getTableRange());if(50>pn(a).height)return!1}return jY.prototype.Vya.call(this)};p.eLa=function(){MMe(null,this.ma,null,this.D)};p.pOa=function(a){MMe(a,this.ma,null,this.D)};p.eRb=function(){TAf(this)&&SAf(this)};
p.P2=function(){var a=jY.prototype.P2.call(this);a&&(this.C=null,TAf(this)&&SAf(this));return a};function TAf(a){a=a.J;return GJ(a.C)&&DN(a)}
function SAf(a){if(a.Cz()){var b=a.J.C,c=JJ(b),d=xkd(c);if(0<d.length)b=JT(d[0].getTableRange()),a.C&&b.equals(JT(a.C.getTableRange()))||(a.C=d[0],a.YY());else if(null!=a.C){d=JT(a.C.getTableRange());b=d.ib()!=CJ(b);var e=!1;if(!b){var f=zK(c);c=ritz_api.TablesApi.getCurrentlyDetectedTables(ln(jn(f,c.dc())));c=ia(c);for(f=c.next();!f.done;f=c.next())if(rn(JT(f.value.getTableRange()),d)){e=!0;break}}if(b||!e)a.C=null,a.L.C(36726,bWe(a)),a.YY()}}else a.kD()}
p.YY=function(){var a=this;this.kD();if(this.C){var b=JT(this.C.getTableRange()),c=[mn(b)];null!=this.xa&&this.xa.cancel();5E4<pya(b)?this.L.C(36727,bWe(this)):(this.xa=eWe(this.Qa,c),$o(this.xa.then(function(d){a.Gb()&&UAf(a,d.C)}),function(){a.kD()}))}};
function UAf(a,b){a.ma=b;var c=null;b=ia(b);for(var d=b.next();!d.done;d=b.next())d=d.value,3==kg(d,1)&&(c=d);if(c&&.6<D(c,2)){a.L.C(36728,bWe(a));b=D(c,9)||new CK;var e=Tc(jg(b,1),function(l){return l.getName()}),f=[],h=[];d=ia(jg(b,2));for(var k=d.next();!k.done;k=d.next())k=k.value,f.push(k.getName()),h=h.concat(jg(k,2));d=mn(mW(c));k=dg(c,11)?D(c,11):null;c=null==k?null:mn(D(c,10));a.R.init(b,d,c,k,[],[]);a.R.nX();a.R.G4().then(function(l){var n=h;l=void 0===l?[]:l;(e.length||f.length||n.length||
l.length)&&a.Na(!0);a.V.nya(e,f,n);0<l.length&&a.V.AY(l);a.F&&QTe(a.F)})}NMe(a.ma,null,a.D)}p.kD=function(){jY.prototype.kD.call(this);this.ma=[];this.R.reset();NMe(null,null,this.D)};function VAf(a,b){qT.call(this,void 0,b,!1,!0);this.H=a;this.setTitle("Lis\u00e4tiedot");this.C.setVisible(!1)}u(VAf,qT);
VAf.prototype.Ca=function(){var a=this;qT.prototype.Ca.call(this);ex(this.La(),"waffle-assistant-feedback-product-info-dialog");var b=Object.keys(this.H).map(function(c){var d=a.H[c];return Ee("DIV",void 0,[Ee("DT",void 0,c+":"),Ee("DD",void 0,String(d))])});tx(this,Ge(b))};VAf.prototype.Ia=function(){qT.prototype.Ia.call(this);var a=vx(this);if(a){var b=Rw(a);cz(a,b,void 0)}};
function WAf(a){var b=a.$Q,c=a.index,d=a.checked;return S(R(XS({ad:"waffle-assistant-feedback-dialog-radio-button",name:Aw(""+R(a.name)),label:b,checked:d,value:c+1},void 0)))}
function XAf(){var a='<div class="'+T("waffle-assistant-feedback-dialog-legal")+'"><small><div class="'+T("waffle-assistant-feedback-dialog-legal-information-text")+'">';a=a+'Antamiesi tietojen avulla ratkomme teknisi\u00e4 ongelmia ja kehit\u00e4mme palveluitamme <a href="https://www.google.com/intl/en/policies/privacy/" target="_blank" class="uf-legal-link">tietosuojak\u00e4yt\u00e4nn\u00f6n</a>ja <a href="https://www.google.com/intl/en/policies/terms/" target="_blank" class="uf-legal-link">k\u00e4ytt\u00f6ehtojen</a> mukaisesti.</div><div class="'+(T("waffle-assistant-feedback-dialog-product-info-display-text")+
'"><span tabindex="0" role="link">');return S(a+"Googlelle jaettavat tiedot</span></div></small></div>")}function YAf(a,b){qT.call(this,void 0,b,!0,!0);this.R=a;this.L=a.zva();this.ma=a.Ooa();this.H=this.V=this.O=null;this.setTitle(a.Eoa());this.C.setContent("L\u00e4het\u00e4")}u(YAf,qT);p=YAf.prototype;
p.Ca=function(){qT.prototype.Ca.call(this);ex(this.La(),"waffle-assistant-feedback-dialog");var a=this.ma;var b=this.L.length,c=this.R.Uoa();wa(a);var d="";if(0<b){d+='<div class="'+T("waffle-assistant-feedback-dialog-header")+'">';d=d+'Viimeisimm\u00e4t ehdotukset</div><div class="'+(T("waffle-assistant-feedback-dialog-suggestions-radio-buttons-control")+'">');b=Math.max(0,Math.ceil(b));for(var e=0;e<b;e++){var f=e;d+=WAf({name:"waffle-assistant-feedback-dialog-suggestions-radio-buttons",$Q:"",checked:f==
c,index:f})}d+="</div>"}d+='<div class="'+T("waffle-assistant-feedback-dialog-header")+'">';d+="Ongelma</div>";if(0<a.length){d+='<div class="'+T("waffle-assistant-feedback-dialog-feedback-radio-buttons-control")+'">';c=a.length;for(b=0;b<c;b++)d+=WAf({name:"waffle-assistant-feedback-dialog-feedback-radio-buttons",$Q:a[b],checked:!1,index:b});d+=WAf({name:"waffle-assistant-feedback-dialog-feedback-radio-buttons",$Q:"Muu",checked:!1,index:a.length});d+="</div>"}d+='<div class="'+T("waffle-assistant-feedback-dialog-other-feedback-textarea-wrapper")+
'"><textarea class="'+T("waffle-assistant-feedback-dialog-other-feedback-textarea")+" "+T("jfk-textinput")+'" placeholder="'+T("Kerro meille hieman lis\u00e4\u00e4")+'"></textarea></div>';a=S(d);tx(this,vw(a));a=wx(this);this.qa().Sr(a,Sx(XAf),0)};
p.Ia=function(){var a=this;qT.prototype.Ia.call(this);var b=vx(this);b&&U8a(b,Rw(b));if(0<this.L.length)for(this.O=yRe("waffle-assistant-feedback-dialog-suggestions-radio-buttons",this.Fa("waffle-assistant-feedback-dialog-suggestions-radio-buttons-control")),this.va(this.O),b=0;b<this.L.length;b++){var c=this.L[b];RX(this.O,b).Md(this.R.render(c))}0<this.ma.length&&(this.V=yRe("waffle-assistant-feedback-dialog-feedback-radio-buttons",this.Fa("waffle-assistant-feedback-dialog-feedback-radio-buttons-control")),
this.va(this.V));b=this.Fa("waffle-assistant-feedback-dialog-product-info-display-text");c=new Zx(b);this.va(c);this.getHandler().listen(b,"click",this.$Na).listen(c,"key",function(d){13===d.keyCode&&(a.$Na(),d.stopPropagation())})};p.KC=function(){var a=ZAf(this);bob.wb(a,a.wUa);var b=this.R.yaa();b&&b(a);qT.prototype.KC.call(this)};
function ZAf(a){var b=null;a.O&&(b=parseInt(uRe(a.O),10)-1,b=a.L[b]);var c=-1;a.V&&(c=parseInt(uRe(a.V),10)-1);var d=a.Fa("waffle-assistant-feedback-dialog-other-feedback-textarea");d=Cd(d.value)||"[No feedback entered]";return a.R.yva(b,c,d)}p.$Na=function(){var a=this,b=ZAf(this).ufa;this.H=new VAf(b,this.qa());this.H.setVisible(!0);this.getHandler().listen(this.H,"hide",function(){Hf(a.H);a.H=null})};p.Ja=function(){qT.prototype.Ja.call(this);Hf(this.H)};
function $Af(a,b,c,d){A.call(this);this.F=b;this.Ya=d;this.C=new Xn(this);this.va(this.C);this.C.listen(this.F,["selectionChange","valueChange"],this.D)}u($Af,A);$Af.prototype.D=ba();
function aBf(){return S('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-before-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-preview"></div><div class="waffle-assistant-after-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-highlights"></div></div>')}
function bBf(a,b,c){b=c||b;return S(R(Nz({ad:"waffle-assistant-insert-chart-button waffle-assistant-readonly-hidden",content:Aw(""+R(jB({icon:"docs-icon-img docs-icon-insert-autovis-chart"},b))),style:4},b))+'<div class="waffle-assistant-button-separator waffle-assistant-readonly-hidden"></div>'+R(Nz({ad:"waffle-assistant-zoom-button",content:Aw(""+R(jB({icon:"docs-icon-img docs-icon-zoom-in"},b))),style:4},b)))}function cBf(a,b,c,d){Q.call(this,d);this.O=a;this.D=b;this.C=c;Cy(xy(new wy,10))}
u(cBf,Q);cBf.prototype.SLa=function(a,b){this.F(this.O,2746,a,b)};
function dBf(a){var b=a.Mfb,c='<div class="waffle-assistant-facet-section"><div class="waffle-assistant-facet-header"><div class="waffle-assistant-pie-icon"></div><div class="waffle-assistant-facet-top-text">',d='Lajitteluehto: <span class="waffle-assistant-facet-title">'+(R(a.Z8a)+"</span>");a=0==b.length;c=c+d+'</div><div class="waffle-assistant-facet-toggle" tabindex="0"></div></div>';if(a)b=S('<div class="waffle-assistant-facet-by-color-container"><div class="waffle-assistant-faceted-chart waffle-assistant-facet-by-color"></div></div>');else{d=
'<div class="waffle-assistant-facet-charts-container">';for(var e=b.length,f=0;f<e;f++){var h=b[f];d+=(0==f%2?'<div class="waffle-assistant-facet-chart-row">':"")+'<div class="waffle-assistant-single-facet"><div class="waffle-assistant-single-facet-title">';d=h?d+R(h):d+"(tyhj\u00e4)";d+='</div><div class="waffle-assistant-faceted-chart"></div></div>'+(1==f%2||f==e-1?"</div>":"")}b=S(d+"</div>")}c+='<div class="waffle-assistant-facet-content-wrapper'+(a?" waffle-assistant-facet-white-section":"")+
'">'+b+(mC?'<div class="waffle-assistant-facet-feedback-container"></div><div class="waffle-assistant-facet-thumbs-container"></div>':"")+"</div></div>";return S(c)}function eBf(){TWc.apply(this,arguments)}u(eBf,TWc);eBf.prototype.Dpa=g("element");function fBf(){IWc.call(this);JWc(this,this);this.xa="waffle-assistant-dragged-card"}u(fBf,JR);fBf.prototype.contains=function(a){return!!Qc(this.F,function(b){if(b.element==a)return!0})};
fBf.prototype.X1=function(a){var b=JR.prototype.X1.call(this,a);a=a.querySelectorAll("CANVAS");for(var c=b.querySelectorAll("CANVAS"),d=0;d<a.length;d++)c[d].getContext("2d").drawImage(a[d],0,0);return b};function gBf(a,b,c,d,e,f,h,k,l,n){cBf.call(this,e,f,h,n);this.V=a;this.L=b;this.ma=c;this.H=d;this.R=k;this.J=l}u(gBf,cBf);gBf.prototype.Ia=function(){cBf.prototype.Ia.call(this);URe(this.ma,this.La(),this.D,this.C,void 0,void 0,this.H)};
gBf.prototype.F=function(a,b,c,d){JJ(this.V).dispatchEvent(new KQe(this.L.copy(),this.H,a,b,c,d,void 0,this.R,this.J))};function hBf(a,b,c,d,e,f){cBf.call(this,c,d,e,f);this.R=a;this.J=b;this.H=null}u(hBf,cBf);hBf.prototype.Ia=function(){cBf.prototype.Ia.call(this);(new vW(dkc,this.J.Ik)).send(v(this.L,this,this.J))};hBf.prototype.F=function(a,b,c,d){this.dispatchEvent(new LQe(this.R.clone(),a,this.H,b,c,d))};
hBf.prototype.L=function(a,b){if(b)if(b.Xj())SM.fI(this.La(),b);else{a.vj(b.Pe());MX(a,a.Pe());var c=(b=a.Pe())?b.toJSON():null,d=ritz.charts.model.GvizChart.create();d.updateChartWrapperJsonString(a.toJSON());c&&d.updateDataTableJsonString(c);URe(d,this.La(),this.D,this.C,void 0,void 0,void 0);this.H=b}};
function iBf(a,b,c,d,e,f,h,k){Q.call(this,k);this.C=a;this.Ta=b;this.Ka=c;this.Pa=d;this.R=e;this.Ha=f;this.Qa=h;this.H=jg(this.C,23);this.O=D(this.C,22);this.F=D(this.C,26);this.V=[];this.Oa=new Mk;this.xa=this.L=this.D=null;this.Ba=!1;this.Ea=new Oz("",this.qa());this.Ga(this.Ea);this.J=this.ma=null}u(iBf,Q);p=iBf.prototype;p.Ca=function(){Q.prototype.Ca.call(this);this.jb(Sx(dBf,{Z8a:this.F,Mfb:this.H}));this.La().style.visibility="hidden"};
p.Ia=function(){Q.prototype.Ia.call(this);var a=this.Fa("waffle-assistant-facet-toggle");this.Ea.Va(a);this.getHandler().listen(this.La(),"mousedown",this.aRb).listen(this.Ea,"action",this.jGb);mC&&(this.xa=new hPe("assistantAutovisFacetFeedback",null,"",this.qa()),this.xa.render(this.Fa("waffle-assistant-facet-feedback-container")),this.D=new mPe(this.qa()),this.Ga(this.D),this.D.render(this.Fa("waffle-assistant-facet-thumbs-container")),nPe(this.D,this.H.length?"Oliko n\u00e4ist\u00e4 kaavioista hy\u00f6ty\u00e4?":
"Oliko t\u00e4st\u00e4 kaaviosta hy\u00f6ty\u00e4?"),this.getHandler().listen(this.D,"thumbs-up",this.aGb).listen(this.D,"thumbs-down",this.$Fb));jBf(this,Ic(z(),"fefsbd"))};p.Ld=g("Ba");p.aRb=function(a){a.stopPropagation()};p.jGb=function(){var a=Vw(this.Fa("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden");jBf(this,a);kBf(this,a?2647:2646)};
function jBf(a,b){var c=a.Fa("waffle-assistant-facet-toggle");Eo(c,b?"PIILOTA":"N\u00c4YT\u00c4");ix(a.Fa("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden",!b);Qc(a.Ph("waffle-assistant-faceted-chart"),function(e){Fo(e,b)});a.D&&P(a.D.La(),b);var d="N\u00e4yt\u00e4 sarakkeen "+(a.F+" mukaan eritelty kaavio");a="Piilota sarakkeen "+(a.F+" mukaan eritelty kaavio");wX(c,b?a:d)}
function lBf(a,b){var c=a.Ph("waffle-assistant-faceted-chart");1==c.length&&2==b.getTypeOrdinal()&&b.setStackingType(1);var d=D(a.C,28).clone();ig(d,1);for(var e=jg(a.C,27),f=0;f<e.length;f++)d.addRange(e[f]);for(e=0;e<c.length;e++){f="string"===typeof a.H[e]?a.H[e]:null;var h=b.copy();f?h.setFilter(a.O,f):h.setFacet(a.O,[a.O-1]);var k=a,l=h.getTitle();l||(l=yNe(h));h.setTitle(mBf(k,l,f));k=h.copy();k.setChartDataSource(ritz_api.ChartsApi.createChartDataSource(a.Oa.serialize(d)));WRe(k);l=new gBf(a.Ta,
h,k,d,a.Ka,a.Pa,a.R,D(a.C,29),a.Qa,a.qa());a.Ga(l);var n=c[e];l.Va(n);a.V.push(l);nBf(a,n,yNe(h),f);a.ma=k}oBf(a);a.La().style.visibility="visible"}function nBf(a,b,c,d){var e=c+(" eriteltyn\u00e4 sarakkeen "+(a.F+(" mukaan arvolla "+d)));a=c+(" eriteltyn\u00e4 sarakkeen "+(a.F+" mukaan"));Sw(b,d?e:a)}function mBf(a,b,c){var d=b+(", kun "+(a.F+(" on "+c)));a=b+(" sarakkeesta "+a.F);return c?d:a}
function pBf(a){a.setOption("legend","top");a.setOption("titleTextStyle.fontSize",10);a.setOption("allowAsync",!0);a.setOption("applyAggregateData",void 0);a.setOption("pieSliceTextStyle.fontSize",11);a.setOption("tooltip.textStyle.fontSize",11);"BarChart"==a.qe()&&a.setOption("isStacked",!0)}function qBf(a){"BarChart"==a.qe()&&a.setOption("isStacked",!0);a.setOption("applyAggregateData",void 0)}
function oBf(a){a.Ba||Qc(a.V,function(b){var c=b.La();if(!a.Ha.contains(c)){var d=a.Ha;b=new eBf(c,b);JYc(d,b)}})}p.aGb=function(){kBf(this,2649)};p.$Fb=function(){kBf(this,2648);this.xa.show(!0)};function kBf(a,b){if(a.ma)Qrd(a.R,b,new KS,10,a.ma,D(a.C,28));else if(a.J){var c=a.R,d=new KS,e=a.J.qe();d.F=e;(e=a.J.Pe())?d.C=e.clone():d.C=null;Vrd(c,b,d,10,a.J,a.J.Ik)}}
function rBf(a,b,c,d,e,f,h,k){zX.call(this,a,k);this.J=nW(a);this.L=b;this.Bb=c;this.Cb=d;this.R=e;this.Pa=f;this.Kb=h;this.ma=new Oz("",this.qa());this.Ga(this.ma);this.xa=new Oz("",this.qa());this.Ga(this.xa);this.Qa=new Mk;this.$a=null;this.Ka=!1;this.Wa=[];this.Ta=[];this.Za=[];this.Ha=this.C=this.D=this.Ba=null;this.Oa=[];a=oOe(this.Kb,CJ(b));this.F=Cy(yy(xy(new wy,10),a))}u(rBf,zX);p=rBf.prototype;p.WA=function(a){var b=this;this.isDisposed()||(ritz_api.ChartsApi?(this.$a=a,sBf(this)):ritz_api.RitzEntryPoint.loadChartsApi(function(){b.WA(a)}))};
p.NB=function(){var a=this;if(!this.isDisposed())if(Ic(z(),"fecpmr"))if(ritz_api.ChartsApi){var b=CNe(this.createChartModel(),D(this.J,28));Sw(this.La(),b)}else ritz_api.RitzEntryPoint.loadChartsApi(function(){a.NB()});else tBf(this,function(c){c&&(c=DNe(a.L,c),Sw(a.La(),c))},!1)};p.IG=m(!0);p.pC=m("autovisFeedback");p.xF=m(2208);p.wF=m(2207);p.Caa=m("Oliko t\u00e4st\u00e4 kaaviosta hy\u00f6ty\u00e4?");
p.Ca=function(){zX.prototype.Ca.call(this);AX(this).appendChild(Sx(aBf));qPe(this).appendChild(Sx(bBf));if(dg(this.J,22)){this.C=new iBf(this.J,this.L,this.V,this.Cb,this.R,this.Pa,this.Oa,this.qa());this.Ga(this.C,!0);var a=this.C,b=this.Ld();a.Ba=b;oBf(a)}};
p.Ia=function(){zX.prototype.Ia.call(this);ex(this.La(),"waffle-assistant-card-draggable");var a=this.Fa("waffle-assistant-insert-chart-button");this.ma.Va(a);wX(a,"Lis\u00e4\u00e4 kaavio.");a=this.Fa("waffle-assistant-zoom-button");this.xa.Va(a);wX(a,"N\u00e4yt\u00e4 t\u00e4ysikokoinen kuva.");a=this.Fa("waffle-assistant-before-chart-preview");var b=this.Fa("waffle-assistant-after-chart-preview");this.getHandler().listen(this.La(),"keydown",this.ZQb).listen(a,"focus",this.gmb).listen(b,"focus",this.alb).listen(this.ma,
"action",this.Zub).listen(this.ma.La(),"mousedown",this.Qua).listen(this.xa,"action",this.XHb).listen(this.xa.La(),"mousedown",this.Qua).listen(this.Fa("waffle-assistant-chart-highlights"),"mousedown",this.Qua).listen(TH(this.L),"Db",this.$Qb);uBf(this);this.R.C(2790,this.F);this.C&&this.R.C(2791,this.F)};p.Ov=function(a){zX.prototype.Ov.call(this,a);uBf(this);this.Gb()&&vBf(this)};
function uBf(a){if(a.Gb()){var b=a.Ld();a.ma.setVisible(!b);a=a.qa().Fa("waffle-assistant-button-separator",qPe(a));P(a,!b)}}p.ZQb=function(a){13==a.keyCode&&a.target==this.La()&&(a.preventDefault(),a.stopPropagation(),wBf(this,2255))};
function xBf(a){var b=a.qe(),c=!!D(a.J,14),d=D(a.J,16),e=!!D(a.J,15),f="Histogram"==b;b="PieChart"==b;var h=qn(jg(a.H,4));if(!h[0]||h[0].C==CJ(a.L)){for(var k=1<h.length,l=[],n=0;n<h.length;n++){var q=h[n].rect;q=c!=b?kxa(q,new hm(q.width,1)):kxa(q,new hm(1,q.height));ld(l,q)}c=XK(a.Bb).F;var r=[];for(w in Uwa)r.push(Dtc(c,Uwa[w]));var w=Tc(l,function(x){return Tc(r,Ja(ym,x))});f&&e&&(w=md(w,1));a.Za=yBf(w.length,b&&0<d||!f&&!b&&e,b&&k);d=XK(a.Bb);for(e=0;e<w.length;e++)for(f=a.Za[e],b=0;b<w[e].length;b++)w[e][b]&&
Km(w[e][b])&&(k=DHe(d,w[e][b],"waffle-assistant-styled-rect"),a.va(k),oQ(d.V,"default",k,!0),Lv(k.La(),"background-color",f),k.setVisible(!0),a.Wa.push(k),k=rQ(d,w[e][b],"waffle-assistant-styled-border",1,0),a.va(k),Hsc(k,f),k.setVisible(!0),a.Ta.push(k))}}function zBf(a){If(a.Wa);If(a.Ta);a.Wa=[];a.Ta=[];a.Za=[]}p.$Qb=function(){this.Ka&&(zBf(this),xBf(this))};p.zQ=function(){zX.prototype.zQ.call(this);this.Ha=La();this.Ka||(xBf(this),this.Ka=!0)};
p.QK=function(){zX.prototype.QK.call(this);"number"===typeof this.Ha&&500<La()-this.Ha&&this.R.C(2789,this.F);this.Ha=null;zBf(this);this.Ka=!1};p.gmb=function(){var a=this.Fa("waffle-assistant-chart-highlights");cw(a)?a.focus():this.La().nextSibling&&this.La().nextSibling.focus()};p.alb=function(){this.O&&iPe(this.O)||this.xa.La().focus()};p.Zub=function(){wBf(this,2255)};p.Qua=function(a){a.stopPropagation()};p.XHb=function(){qob.wb(this,this.F)};p.SLa=function(a,b){wBf(this,2257,a,b)};
function wBf(a,b,c,d){if(Ic(z(),"fecpmr")){var e=a.createChartModel();JJ(a.L).dispatchEvent(new KQe(e,D(a.J,28),a.V,b,c,d,Ij(a.F),D(a.J,29),a.Oa))}else tBf(a,function(f){f&&(f=new LQe(f,a.V,a.D&&a.D.Pe(),b,c,d,Ij(a.F),D(a.J,29),a.Oa),JJ(a.L).dispatchEvent(f))},!1)}function ABf(a,b){URe(b,BBf(a),a.Cb,a.R,function(){null!==a.Ba&&(jk(gk(),a.Ba),a.Ba=null);a.isDisposed()||(a.$a(),vBf(a))})}function vBf(a){if(!a.Ld()){var b=BBf(a);if(!a.Pa.contains(b)){var c=a.Pa;a=new eBf(b,a);JYc(c,a)}}}
function CBf(a,b,c){var d=[];try{var e=a.Qa.serialize(c),f=ritz_api.RitzModelApi.getVerbalHighlightsForProto(e,ritz.charts.model.ChartTypes.toGviz(b.getTypeOrdinal()),0!=b.getStackingTypeOrdinal(),b.getTitle(),hY(b,ritz.charts.model.AxisNames.X),hY(b,ritz.charts.model.AxisNames.Y),hY(b,ritz.charts.model.AxisNames.RIGHT),b.getDomainDataBacked());d=Tc(f,YVe)}catch(h){d=[]}a=a.Fa("waffle-assistant-chart-highlights");P(a,0<d.length);0<d.length&&(a.appendChild(d[0]),Fo(a,!0))}
p.createChartModel=function(){DBf(this);var a=ritz.charts.model.ChartImpl.create(),b=D(this.J,28);a.setChartModel(this.Qa.serialize(b.ql()));a.setChartDataSource(ritz_api.ChartsApi.createChartDataSource(this.Qa.serialize(b)));return a};function EBf(a){DBf(a);D(a.J,16);var b=kQe(a.J);b.kya(dkc);var c=VPe(a.H);b.qo(c.toString());a.C&&(c=c.clone(),a.C.L=c);return b}function DBf(a){a.ge&&(a.Ba=ik(gk(),"aaoar"),a.ge=!1)}
function sBf(a){if(Ic(z(),"fecpmr")){var b=a.createChartModel(),c=b.copy();WRe(c);CBf(a,b,D(a.J,28));ABf(a,c);a.C&&lBf(a.C,b)}else{var d=lQe(EBf(a),a.Fa("waffle-assistant-card-inner"));(new vW(dkc,d.Ik)).send(function(e){if(e)if(e.Xj())SM.fI(BBf(a),e);else{d.vj(e.Pe());MX(d,d.Pe());e=new Wr;e.setContext(d.toJSON());var f=!!D(a.J,14);E(e,3,f);var h=D(a.J,16);E(e,4,h);E(e,5,f);E(e,8,0);D(a.J,24)&&(f=D(a.J,25),E(e,9,f));f=qn(jg(a.H,4));for(h=0;h<f.length;h++)e.addRange(jn(f[h].rect,f[h].C));f=(f=d.Pe())?
f.toJSON():null;h=ritz.charts.model.GvizChart.create();h.updateChartWrapperJsonString(d.toJSON());f&&h.updateDataTableJsonString(f);CBf(a,h,e);a.D=d;e=(e=d.Pe())?e.toJSON():null;f=ritz.charts.model.GvizChart.create();f.updateChartWrapperJsonString(d.toJSON());e&&f.updateDataTableJsonString(e);ABf(a,f)}});a.C&&tBf(a,function(e){var f=a.C,h=d;e=new ZM(e.toJSON());h=new ZM(h.toJSON());var k=f.Ph("waffle-assistant-faceted-chart");if(1<k.length){qBf(e);var l=h;pBf(l);l.setOption("pieSliceText","percentage");
l.setOption("axisFontSize",0);l.setOption("hAxis.title",null);l.setOption("hAxis.textPosition","none");l.setOption("vAxes.0.title",null);l.setOption("vAxes.0.textPosition","none");l.setOption("vAxes.1.title",null);l.setOption("vAxes.1.textPosition","none");l.setOption("legend","none");l.setOption("titleTextStyle.fontSize",0)}else l=e,qBf(l),l.setOption("applyAggregateData",void 0),l.setOption("legend","right"),pBf(h);l=qn(jg(f.C,27));ekc(f.L,l);l=D(f.C,25);for(var n=0;n<k.length;n++){var q="string"===
typeof f.H[n]?f.H[n]:null,r=l.clone(),w=f.O,x=new bs;E(x,1,w);"string"===typeof q&&x.setValue(q);E(r,7,x);f.L.zc("dt",encodeURIComponent(JSON.stringify(f.Oa.serialize(r))));r=new ZM(e.toJSON());r.qo(f.L.toString());w=h.clone();w.qo(f.L.toString());x=f;var B=r.getOption("title");B||(B=zNe(r));x=mBf(x,B,q);r.setOption("title",x);w.setOption("title",x);x=new hBf(r,w,f.Ka,f.Pa,f.R,f.qa());f.Ga(x);B=k[n];x.Va(B);f.V.push(x);nBf(f,B,zNe(r),q);f.J=w}oBf(f);f.La().style.visibility="visible"},!1)}}
function tBf(a,b,c){var d=EBf(a);(new vW(dkc,d.Ik)).send(function(e){e?(e=e.Pe(),c&&d.vj(e),MX(d,e),b(d)):b(null)})}p.qe=function(){return this.J.qe()};function yBf(a,b,c){var d=b?["#666"]:[];c&&(a/=2);b&&--a;b=iQe("material").colors;for(var e=0;e<a;e++)d.push(b[e%b.length].color);c&&ld(d,d);return d}function BBf(a){return a.Fa("waffle-assistant-chart-preview")}
function FBf(a,b,c){b=c||b;a=a.title;c='<div class="waffle-assistant-feature-section" tabindex="0" role="region" aria-label="';var d=" Osio "+(T(a)+" ");c+=Cw(d);c+='"><div class="waffle-assistant-section-header"><div class="waffle-assistant-section-title">'+R(a)+"</div>";c+=R(Nz({ad:"waffle-assistant-section-more-button",content:Aw("Lis\u00e4tietoja"),style:4},b));return S(c+'</div><div class="waffle-assistant-section-content"></div><div class="waffle-assistant-section-card-holder"></div></div>')}
function W_(a,b,c,d){Q.call(this,d);this.V=a;this.Za=b;this.xa=new Oz("",this.qa());this.Ga(this.xa);this.L=new Q(this.qa());this.Ga(this.L);this.C=null;this.Oa=[];this.ma=this.Ka=!1;this.O=c}u(W_,Q);p=W_.prototype;p.BOa=m(!1);p.Sya=m(!0);p.Ca=function(){Q.prototype.Ca.call(this);this.jb(Sx(FBf,{title:this.getTitle()}))};
p.Ia=function(){Q.prototype.Ia.call(this);this.L.Va(this.Fa("waffle-assistant-section-card-holder"));this.xa.Va(this.Fa("waffle-assistant-section-more-button"));this.getHandler().listen(this.xa,"action",this.kxb);this.C=this.ZEa();this.va(this.C);P(GBf(this),this.BOa());this.setVisible(!1)};p.setVisible=function(a){this.Gb()&&this.isVisible()!=a&&(P(this.La(),a),a&&(P(this.xa.La(),this.tZa()),a=new tj,a=M(a,4,this.I4()),a=uj(new qj,a),a=Cy(yy(xy(new wy,10),a)),this.O.C(2774,a)))};
p.isVisible=function(){return this.Gb()&&cw(this.La())};p.tZa=function(){return this.Oa.length>this.V};p.ZEa=function(){return new WX(this.qa())};p.EQ=function(a){this.ma=a;Qc(HBf(this),function(b){b.Ov(a)});mUe(this.C,a)};p.Ld=g("ma");p.ASa=ba();
p.CQ=function(a){this.Oa=a;for(var b=0;b<a.length;b++){if(this.L.rc()<this.V){var c=this.KT(a[b]);c.Ov(this.ma);var d=this.L.rc();c.V=d;this.L.Ga(c,!0)}if(this.Sya()&&(this.C.zH(!1),c=this.KT(a[b]),c.Ov(this.ma),d=this.C,d.C.push(c),d.yd)){kUe(d,!1);var e=d.O.rc();c.V=e;d.O.Ga(c,!0);c.ZN()}}};function HBf(a){var b=[];a.L.Oe(function(c){b.push(c)});return b}function GBf(a){return a.Fa("waffle-assistant-section-content")}p.Nra=function(){return this.L.U2()};
p.DQ=function(){this.Oa=[];If(this.L.od(!0));this.setVisible(!1);this.Sya()&&(this.C.Q_(),this.C.zH(!0))};function IBf(a){a.L.Oe(function(b,c){c<this.V&&b.ZN()},a)}p.J4=function(a){var b=0;if(this.Ka)this.C.BSa();else if(this.Nra()){this.setVisible(!0);b=$v(this.Fa("waffle-assistant-section-header")).height+$v(GBf(this)).height;for(var c=HBf(this),d=0;d<c.length;d++)b<a&&d<this.V?(this.kLa(c[d]),sPe(c[d],!0),b+=$v(c[d].La()).height):sPe(c[d],!1)}else this.setVisible(!1);return a-b};p.kLa=ba();
p.setActive=function(a){(this.Ka=a)||this.C.s9()};p.Xb=g("Ka");p.Pn=function(a){this.C&&kUe(this.C,a)};function JBf(a,b){a.C.Oga(b,a.getTitle())}p.kxb=function(){this.setActive(!0);this.dispatchEvent("Cd")};function KBf(){return S('<div class="waffle-assistant-word-cloud-card"><div class="waffle-assistant-word-cloud-title"></div><div class="waffle-assistant-word-cloud-words-container"></div></div>')}function LBf(a,b){zX.call(this,a,b);this.C=nW(a)}u(LBf,zX);p=LBf.prototype;p.NB=ba();p.pC=m("assistantWordCloudFeedback");
p.xF=m(2634);p.wF=m(2633);p.Ca=function(){zX.prototype.Ca.call(this);AX(this).appendChild(Sx(KBf));ex(AX(this),"waffle-assistant-word-cloud-content-container")};p.WA=function(a){for(var b=jg(this.C,19),c=jg(this.C,20),d=this.Fa("waffle-assistant-word-cloud-words-container"),e=0;e<b.length;e++)if(MBf(this,b,c,e),120<d.clientHeight){MBf(this,b,c,e-1);break}b=this.qa();c=D(this.C,2);c=Oo(b,c);d=this.Fa("waffle-assistant-word-cloud-title");b.appendChild(d,c);a()};
function MBf(a,b,c,d){var e=a.Fa("waffle-assistant-word-cloud-words-container");for(a=a.qa();e.firstChild;)e.removeChild(e.firstChild);for(var f=c[d],h=c[0],k=0;k<=d;k++){0!=k&&e.appendChild(Oo(a," "));var l=a.createElement("SPAN");a.appendChild(l,Oo(a,b[k]));a.appendChild(e,l);ex(l,"waffle-assistant-word-cloud-word");var n=c[k];l.style.color=0==k%2?"#00695C":"#61443C";l.style.fontSize=(n-f)/(h-f)*15+9+"px"}}
function NBf(a,b,c,d,e,f){var h=Kc(z(),"fmnac");h||(h=20);W_.call(this,h,e,d,f);this.Ba=a;this.H=b;this.Ea=c;this.D=new fBf;this.va(this.D);this.F=null;this.R=0;this.J=null}u(NBf,W_);p=NBf.prototype;p.Ia=function(){W_.prototype.Ia.call(this);this.D.init();this.getHandler().listen(this.D,"drag",this.YQb).listen(this.D,"dragend",this.$l)};p.getTitle=m("Analyysi");p.D_=function(a){return 0==a};
p.KT=function(a){return"WordCloud"==nW(a).qe()?new LBf(a,this.qa()):new rBf(a,this.Ba,this.H,this.Ea,this.O,this.D,this.J,this.qa())};p.EQ=function(a){W_.prototype.EQ.call(this,a);a&&MWc(this.D)};p.kLa=function(a){this.getHandler().Rc(a,"content-rendered",this.XQb);this.R++};p.CQ=function(a,b){this.J=b||null;W_.prototype.CQ.call(this,a,b);var c=a.map(function(d){return nW(d).qe()});Qc(HBf(this),function(d){d instanceof rBf&&(d.Oa=c)})};p.XQb=function(){0==--this.R&&this.dispatchEvent("yd")};
p.YQb=function(){this.F=Wv(this.D.Oc.target)};p.$l=function(a){var b=this.F,c=XK(this.H).C;if(mm(DO(c,"page",!1,!1)).contains(b)){var d=lP(c,b.x,b.y,"page");c=nP(c,d,"page");b=new bm(b.x-c.left,b.y-c.top);a.C.getData().SLa(d,b)}this.F=null};p.I4=m(2);
function OBf(a,b,c){b=c||b;a=S;c='<div class="'+T("waffle-assistant-answers-logging-message-container")+'"><div class="'+T("waffle-assistant-answers-logging-message")+'"><span class="'+T("waffle-assistant-answers-logging-text")+'">';c=c+'Kyselyt ja tiedot tallennetaan lokiin ominaisuuden parantamiseksi.</span><div class="'+(T("waffle-assistant-answers-learn-more")+'">');c=c+'Lis\u00e4tietoja</div><div class="'+(T("waffle-assistant-answers-logging-opt-out")+'">');c=S(c+"J\u00e4t\u00e4 t\u00e4m\u00e4 tiedosto pois lokista</div></div></div>");
return a(c+'<div class="'+T("waffle-assistant-answers-input")+" "+T("waffle-assistant-answers-input-with-icon")+'"><form class="'+T("waffle-assistant-answers-query-box")+'">'+R(zTe(b))+"</form></div>")}
function PBf(a,b,c,d,e,f,h,k,l,n){W_.call(this,1,f,e,n);this.Wa=c;this.$a=b;this.Ha=null;this.Ea=new Gy("",new BS,this.qa());this.Ga(this.Ea);this.Pa=new Gy("",new BS,this.qa());this.Ga(this.Pa);f=new DP(a,!0,!0);f=new CQe(f);this.Ba=new vPe(e);this.R=new jVe(this.Wa,f,e);this.H=new nVe(this.R,a,b,c,d,e,this.Za,f,this.Ba,h,k,l,this.qa());this.D=new PW(b,"waffle-assistant-answers-styled-border","waffle-assistant-answers-styled-rect");this.va(this.D);this.F=this.J=null;this.Ta=Cy(xy(new wy,10));this.Qa=
!1}u(PBf,W_);p=PBf.prototype;p.Ca=function(){W_.prototype.Ca.call(this);var a=Sx(OBf);this.qa().appendChild(GBf(this),a)};
p.Ia=function(){W_.prototype.Ia.call(this);var a=this.Fa("waffle-assistant-answers-query-box"),b=this.Fa("waffle-assistant-answers-input-box");this.Pa.Va(this.Fa("waffle-assistant-answers-logging-opt-out"));this.Ea.Va(this.Fa("waffle-assistant-answers-learn-more"));this.getHandler().listen(a,"focus",this.$Ab,!0).listen(a,"blur",this.YAb,!0).listen(a,"mouseover",this.bBb).listen(a,"mouseout",this.aBb).listen(a,"click",this.ZAb).listen(b,"input",this.gRb).listen(this.Pa,"action",this.czb).listen(this.Ea,
"action",this.Dvb).listen(TH(this.Wa),"Db",fIe(this.hRb,25,this));this.setVisible(null!=this.J);QBf(this,vlb&&wlb&&oC("showAnswersLoggingOptOut"))};p.tZa=m(!1);p.BOa=m(!0);p.Sya=m(!1);p.getTitle=m("Vastaukset");p.I4=m(1);p.D_=function(a){return 3==a||0==a||1==a};
p.CQ=function(a,b){rd(a,function(l,n){return D(n,2)-D(l,2)});for(var c=[],d=[],e=null,f=0;f<a.length;f++){var h=kg(a[f],1);3==h?e=a[f]:0==h?c.push(nW(a[f])):1==h&&d.push(a[f])}if(e&&D(e,2)){f=b||null;h=dg(e,11)?D(e,11):null;var k=null==h?null:mn(D(e,10));0<eg(e,4)?RBf(this,mn(mW(e)),D(e,9),k,h,c,d):RBf(this,f,D(e,9),k,h,c,d);this.F||(W_.prototype.CQ.call(this,a,b),this.getHandler().listen(this.F,"sqc",this.mFb))}else this.DQ(!0)};
p.KT=function(a){if(!this.F){var b=SUe(this.R,3);this.F=new hVe(a,this.$a,this.O,this.Ba,b,dVe,"regular",void 0,this.qa())}return this.F};p.ZEa=g("H");p.Nra=function(){return this.isVisible()};p.DQ=function(a,b,c){this.R.reset();(a||b)&&this.F&&(W_.prototype.DQ.call(this,a,b,c),this.F.dispose(),this.F=null);if(a||void 0!==b&&!b)this.F&&(W_.prototype.DQ.call(this,a,b,c),this.F.dispose(),this.F=null),this.Gb()&&(this.R.reset(),this.J=null,sVe(this.H),this.setVisible(!1),this.Xb()&&zW(this.D));c&&this.H.reset()};
p.Pn=function(a,b){b||kUe(this.H,a)};p.ASa=function(a){this.Ha=a;var b=this.H;b.Ka=a;b.xa.lD(a);b.Ta.lD(a);this.R.L=a;this.Ba.C=a};p.setActive=function(a){W_.prototype.setActive.call(this,a);a?SW(this.D,this.J):zW(this.D)};function SBf(a,b){a.Xb()&&(b?zW(a.D):SW(a.D,a.J))}function QBf(a,b){P(a.Fa("waffle-assistant-answers-logging-message-container"),b)}function TBf(a,b){a=a.Fa("waffle-assistant-answers-query-box");ix(a,"waffle-assistant-answers-query-box-focused",b)}
p.hRb=function(){this.Xb()&&SW(this.D,this.J)};p.$Ab=function(){TBf(this,!0);SW(this.D,this.J)};p.YAb=function(){TBf(this,!1);this.Xb()||zW(this.D)};p.bBb=function(){SW(this.D,this.J)};p.aBb=function(){this.Xb()||zW(this.D)};p.ZAb=function(){UBf(this,"")};p.gRb=function(){var a=this.Fa("waffle-assistant-answers-input-box");Te(a.value)||(UBf(this,a.value),a.value="")};p.mFb=function(a){UBf(this,a.C,!1,!0,a);this.O.C(2652,this.Ta)};
function UBf(a,b,c,d,e){c=void 0===c?!1:c;d=void 0===d?!1:d;a.setActive(!0);a.dispatchEvent("Cd");VBf(a,b,c);if(d&&b){var f=new AV;e instanceof bVe?f=tOe(1,e.F,e.D,1):e instanceof FTe&&(f=FVe(e));c=new Qp(function(){rVe(a.H,b,f,e)},300);a.va(c);c.start()}}function VBf(a,b,c,d,e){c=void 0===c?!1:c;d=void 0===d?!1:d;var f=new Qp(function(){var h=a.H;h.D&&PTe(h.D,b,!0);h=a.H;var k=c||!1;h.He=k;h.zd.R=k;h.Dc.R=k;d&&b&&(h=new AV,e&&(h=FVe(e)),rVe(a.H,b,h,e))},300);a.va(f);f.start()}
function RBf(a,b,c,d,e,f,h){c=c||new CK;a.J=b;a.R.init(c,b,d,e,f,h);a.R.nX();a.setVisible(null!=b);pVe(a.H,b,c,d,e,a.Qa,f);a.Qa=!1;a.Xb()&&SW(a.D,a.J)}p.czb=function(a){a.stopPropagation();a.preventDefault();this.Ha&&(jq(Vk(Wk(this.Ha.Te("/answers/logoptout"),v(this.gwb,this)),v(this.fwb,this)),"POST").Re(),this.O.C(2663,this.Ta))};p.Dvb=function(a){a.stopPropagation();a.preventDefault();rw("https://docs.google.com/document/d/1VxpmAx5RTnwmeXyj3IuPPYIXg9DYzTS8nz8pi1E_ZJk/preview",{target:"_blank"})};
p.gwb=function(a){a.qj()&&QBf(this,!1)};p.fwb=ba();function WBf(a,b,c){a=S;b=""+R(Nz({ad:"waffle-assistant-datavalidation-apply-button",content:"K\u00e4yt\u00e4",style:4},c||b));b=S(b);return a('<div class="waffle-assistant-datavalidation-rule-group"><div class="waffle-assistant-datavalidation-details"></div><div class="waffle-assistant-datavalidation-description"></div>'+b+"</div>")}function XBf(a){return S('<div class="waffle-assistant-datavalidation-detail-chip">'+R(a.u$a)+"</div>")}
function YBf(a,b,c,d){zX.call(this,a,d);this.D=new PW(b,"waffle-assistant-highlight-styled-border","waffle-assistant-highlight-styled-rect");this.va(this.D);this.C=new Oz("",this.qa());this.Ga(this.C);this.F=mW(a);this.L=c}u(YBf,zX);p=YBf.prototype;p.Ca=function(){zX.prototype.Ca.call(this);AX(this).appendChild(Sx(WBf))};
p.Ia=function(){zX.prototype.Ia.call(this);var a=this.Fa("waffle-assistant-datavalidation-apply-button");this.C.Va(a);wX(a,"Ota tietojen vahvistus k\u00e4ytt\u00f6\u00f6n.");this.getHandler().listen(this.C,"action",this.zlb).listen(this.La(),"mouseenter",this.BRb).listen(this.La(),"mouseleave",this.CRb);a=kEe(new tj,lWe(Pg(D(D(this.H,13),3))));a=uj(new qj,a);a=Cy(yy(xy(new wy,10),a));this.L.C(35577,a)};
p.WA=function(a){var b=tN(pn(this.F)),c=D(D(this.H,13),3);switch(Pg(c)){case 14:var d="S\u00e4hk\u00f6postin validointi";c=["On kelvollinen s\u00e4hk\u00f6postiosoite"];break;case 15:d="URL-osoitteen validointi";c=["On kelvollinen URL-osoite"];break;case 30:d="P\u00e4iv\u00e4m\u00e4\u00e4r\u00e4n validointi";c=["On kelvollinen p\u00e4iv\u00e4m\u00e4\u00e4r\u00e4"];break;case 24:d="Kohdeluettelo";c=Qg(c).map(function(k){return D(k.Lo().getValue(),2)});break;case 1:d="Numeerinen vahvistus";c=["Suurempi kuin "+
D(Qg(c)[0].Lo().getValue(),3)];break;case 7:d="Numeerinen vahvistus";c=Qg(c);c=["Arvojen "+(D(c[0].Lo().getValue(),3)+(" ja "+(D(c[1].Lo().getValue(),3)+" v\u00e4liss\u00e4")))];break;case 5:d="Numeerinen vahvistus";c=Qg(c);c=["Yht\u00e4 suuri kuin "+D(c[0].Lo().getValue(),3)];break;default:d="unrecognized",c=[]}var e=new iC,f=e.text(d)+(" v\u00e4lille "+(e.qd("SPAN".toString(),{pI:"waffle-assistant-datavalidation-range"})+e.text(b)+e.jd("SPAN".toString())));Dga(this.Fa("waffle-assistant-datavalidation-description"),
e.format(f));var h=this.Fa("waffle-assistant-datavalidation-details");Qc(c,function(k){k=Sx(XBf,{u$a:k});h.appendChild(k)});b="Ehdotettu datan vahvistus: "+(d+(" "+(c.join()+(" v\u00e4lille "+b))));Sw(this.La(),b);a()};p.NB=ba();p.pC=m("assistantDataValidationFeedback");p.xF=m(35551);p.wF=m(35550);p.zlb=function(){this.dispatchEvent(new yX("vd",this,35549))};p.BRb=function(){SW(this.D,mn(this.F))};p.CRb=function(){zW(this.D)};function ZBf(a,b,c,d){W_.call(this,1,b,a,d);this.D=c}u(ZBf,W_);p=ZBf.prototype;
p.getTitle=m("Tietojen vahvistus");p.D_=function(a){return 6==a};p.KT=function(a){var b=D(a,1);switch(b){case 6:return new YBf(a,this.D,this.O,this.qa());default:throw Error("Unsupported recommendation type: "+b);}};p.EQ=function(a){W_.prototype.EQ.call(this,a);this.setVisible(!a)};p.J4=function(a){return this.Ld()?(this.setVisible(!1),a):W_.prototype.J4.call(this,a)};p.I4=m(4);function $Bf(a,b,c){yX.call(this,"td",a,b);this.D=c}u($Bf,yX);
function aCf(a){a=""+R(Nz({ad:"waffle-assistant-formatting-edit-button",content:"Muokkaa",style:4},a));return S(a)}function bCf(a,b,c){a='<div class="waffle-assistant-banding-recommendation"><div class="waffle-assistant-banding-color-picker-container"></div><div class="waffle-assistant-banding-range-wrapper">Vaihtelevat v\u00e4rit kohteille <span class="waffle-assistant-banding-range"></span></div>'+(aCf(c||b)+"</div>");return S(a)}
function cCf(a,b,c){return S('<div class="waffle-assistant-conditionalformat-rule-group"><div class="waffle-assistant-conditionalformat-rule-holder" tabindex="0"></div><div class="waffle-assistant-conditionalformat-description"></div>'+aCf(c||b)+"</div>")}function dCf(a,b,c){yX.call(this,"Bd",a,b);this.D=c}u(dCf,yX);
function eCf(a,b,c,d){zX.call(this,a,d);a=Tc(jg(this.H,7),pWe);this.C=new uWe(!1,a,7);this.Ga(this.C);this.L=new Oz("",this.qa());this.Ga(this.L);this.ma=b;this.F=!1;this.D=-1;this.R=c}u(eCf,zX);p=eCf.prototype;p.Ca=function(){zX.prototype.Ca.call(this);AX(this).appendChild(Sx(bCf))};p.Ia=function(){zX.prototype.Ia.call(this);this.getHandler().listen(this.L,"action",this.urb).listen(this.C,"ue",this.bmb);this.ma.C(2768)};
p.WA=function(a){var b=this.Fa("waffle-assistant-banding-color-picker-container");this.C.render(b);vWe(this.C);b=this.Fa("waffle-assistant-banding-range");var c=mW(this.H),d=pn(c);Eo(b,tN(d));fCf(this,c);b=this.Fa("waffle-assistant-formatting-edit-button");this.L.Va(b);a()};p.NB=function(){Sw(this.La(),"Ehdotetut vuorottelevat taustav\u00e4rit");this.C.re("Valitse v\u00e4riteema")};p.pC=m("assistantBandingFeedback");p.xF=m(2672);p.wF=m(2671);
p.urb=function(a){PK.dispatchEvent({type:"show-banding-pane-recommendation",$Wa:this.H,R9a:xWe(this.C)});a.stopPropagation()};p.bmb=function(a){var b=this;if(!this.F&&wWe(this.C)){var c=this.D;this.D=this.C.Xh();this.D==c?this.dispatchEvent(new dCf(this,2797,function(){b.R.clear()})):this.dispatchEvent(new $Bf(this,2673,function(){XQe(b.R,"Vaihtelevia v\u00e4rej\u00e4 on k\u00e4ytetty.",b.qa(),function(){b.dispatchEvent(new yX("Gd",b,2796))})}));a.stopPropagation()}};
function fCf(a,b){a.F=!0;var c=b.ib();b=pn(b);c=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(c,b.Ac(),b.yc(),b.Yc(),b.Xc(),7,!1);c.length?(c=ritz_api.RitzModelApi.getBandedRangeByWorkbookRangeId(c[0]),c=(new Mk).Tc(js.Aa(),c),c=pWe(c)):c=null;c?(c=yWe(a.C,c),eN(a.C,c?c.getElement():null)):eN(a.C,null);a.D=a.C.Xh();a.F=!1}function gCf(a,b){gy.call(this,void 0,void 0,b);this.C=a}u(gCf,gy);
gCf.prototype.Ec=function(a){gy.prototype.Ec.call(this,a);var b=this.C.Sd;switch(b.length){case 0:break;case 1:var c="one-rule";break;case 2:case 4:c="two-rules";break;default:c="three-rules"}for(var d=0;d<b.length;d++){var e=b[d],f=mo("DIV");fx(f,["waffle-assistant-conditionalformat-format-preview",c]);var h=mo("DIV");ex(h,"waffle-assistant-conditionalformat-format-preview-label");f.appendChild(h);Eo(h,"123");if(dg(e,2)){var k=D(D(e,2),1);switch(Pg(Sg(k))){case 9:case 13:k=Qg(Sg(k))[0];var l=jg(e,
1)[0];Eo(h,bI(k,kg(l,1),kg(l,2),kg(l,4)))}}KWe(e,f);a.appendChild(f)}};gCf.prototype.Pg=function(){var a=this.C;a.dispatchEvent(new yX("ud",a,2563));return!0};function hCf(a,b){zX.call(this,a,b);this.C=new Oz("",this.qa());this.Ga(this.C);this.Sd=jg(a,6)}u(hCf,zX);p=hCf.prototype;p.Ca=function(){zX.prototype.Ca.call(this);AX(this).appendChild(Sx(cCf))};
p.Ia=function(){zX.prototype.Ia.call(this);var a=this.Fa("waffle-assistant-formatting-edit-button");this.C.Va(a);wX(a,"K\u00e4yt\u00e4 ja muokkaa ehdollisia muotoilus\u00e4\u00e4nt\u00f6j\u00e4");this.getHandler().listen(this.C,"action",this.xlb)};
p.WA=function(a){Eo(this.Fa("waffle-assistant-conditionalformat-description"),kg(this.H,3));var b=this.Fa("waffle-assistant-conditionalformat-rule-holder"),c=new gCf(this,this.qa());this.Ga(c);c.Va(b);wX(b,"K\u00e4yt\u00e4 ehdollisia muotoilus\u00e4\u00e4nt\u00f6j\u00e4");a()};p.NB=ba();p.pC=m("assistantConditionalFormatFeedback");p.xF=m(2630);p.wF=m(2629);p.xlb=function(){this.dispatchEvent(new yX("ud",this,2563));this.dispatchEvent(new yX("xd",this,2670,void 0,void 0,pn(D(this.Sd[0],1,0))));l2b()};
function iCf(a,b,c){W_.call(this,2,b,a,c)}u(iCf,W_);p=iCf.prototype;p.getTitle=m("Muotoilu");p.D_=function(a){return Ic(z(),"feecfr")&&2==a||4==a};p.KT=function(a){var b=D(a,1);switch(b){case 2:return new hCf(a,this.qa());case 4:return new eCf(a,this.O,this.Za,this.qa());default:throw Error("Unsupported recommendation type: "+b);}};p.EQ=function(a){W_.prototype.EQ.call(this,a);this.setVisible(!a)};p.J4=function(a){return this.Ld()?(this.setVisible(!1),a):W_.prototype.J4.call(this,a)};p.I4=m(3);
function X_(a,b,c,d,e){Q.call(this);this.O=a;this.Ta=b;this.Ka=c;this.J=d;this.C=e}u(X_,Q);X_.prototype.getTableRange=g("Ka");X_.prototype.Sea=function(a,b,c){this.Ka=a;this.J=b;this.C=c};X_.prototype.Ia=function(){Q.prototype.Ia.call(this);this.getHandler().listen(this.O.C,"ga",this.Wa)};X_.prototype.Wa=function(){this.Ta.wb()};function jCf(a,b,c,d){d=void 0===d?!1:d;yX.call(this,"Dd",null,2859);this.R=a;this.O=b;this.D=c;this.F=!!d}u(jCf,yX);jCf.prototype.getTableRange=g("R");
function kCf(a,b){A.call(this);this.F=a;this.H=b;this.C=new PW(a,"waffle-assistant-table-range-border","waffle-assistant-table-range-rect");this.va(this.C);this.D=new PW(a,"waffle-assistant-header-range-border","waffle-assistant-header-range-rect");this.va(this.D)}u(kCf,A);kCf.prototype.Ja=function(){zW(this.C);zW(this.D);A.prototype.Ja.call(this)};
function lCf(a,b,c,d,e,f){gvc(b);var h=NH(d);h=new um(h.Ac(),h.yc(),Math.min(h.Yc(),h.Ac()+6),Math.min(h.Xc(),h.yc()+6));var k=vP(b),l=XK(a.F).C,n=WN(l,new om(h.Ac(),h.Yc()),"r",!0,!1,!0,!0)-1,q=WN(l,new om(h.yc(),h.Xc()),"c",!0,!1,!0,!0)-1;l.jc()&&--q;n=Math.min(200,n);q=Math.min(c.offsetWidth-2,q);hvc(b,k,q,n);c=OAf(d,e,f);a.H.render(b,h,c);b=a.C;h=d.Ac();k=d.yc();switch(e){case 0:h=Math.min(d.Yc(),d.Ac()+f);break;case 1:k=Math.min(d.Xc(),d.yc()+f)}d=tPb(d.ib(),h,k,d.Yc(),d.Xc());SW(b,pGe(d));SW(a.D,
pGe(c))}
function mCf(a){var b=a.zWa,c=a.yWa,d=a.jVa;a=a.G8;return S('<div class="waffle-sidebar-overlay"><div class="waffle-tables-popup" aria-label="'+T(b)+'"><div class="waffle-tables-popup-header"><div class="waffle-tables-popup-title">'+R(b)+'</div></div><div class="waffle-tables-popup-content">'+R(c)+'<div class="waffle-assistant-canvas-container"><canvas class="waffle-assistant-table-canvas"></canvas></div></div><div class="waffle-tables-popup-buttons"><div class="waffle-tables-popup-button waffle-tables-popup-done">'+R(d)+
'</div><div class="waffle-tables-popup-button waffle-tables-popup-cancel">'+R(a)+"</div></div></div></div>")}
function nCf(){var a=S('<div class="waffle-assistant-tables-recommendation"><div class="waffle-assistant-table-range-container"><div class="waffle-assistant-tables-range-wrapper waffle-assistant-tables-data-range-wrapper"><label id="waffle-assistant-tables-data-range-label">Tietoalue</label><div class="waffle-assistant-tables-edit-sheet-button"></div></div><div class="waffle-assistant-tables-range-error" style="display:none">Virheellinen alue</div></div><div class="waffle-assistant-header-range-container"><div class="waffle-assistant-tables-range-wrapper"><div class="waffle-assistant-tables-edit-headers-button"></div></div></div></div>');a=
""+mCf({zWa:"Muokkaa tietoaluetta",yWa:Aw(""+a),jVa:"P\u00e4ivit\u00e4",G8:"Peruuta"});return S(a)}function oCf(){var a=""+mCf({zWa:"Paranna ehdotuksia.",yWa:Aw('<div class="waffle-tables-popup-header-message"></div>'),jVa:"Ei",G8:"Kyll\u00e4"});return S(a)}function pCf(a){a='<div class="waffle-tables-bar-content">Vastaanottaja: <span class="waffle-assistant-table-bar-range">'+(R(a.EB)+"</span></div>");return S(a)}
function qCf(a){a='Onko <span class="waffle-assistant-table-first-header">'+(R(a.OP)+"</span> otsikkorivi, joka sis\u00e4lt\u00e4\u00e4 sarakkeita kuvaavia nimikkeit\u00e4?");return S(a)}
function rCf(a,b,c,d,e,f,h){X_.call(this,a,Wvb,d,e,f);this.D=yB(new xB);this.va(this.D);this.H=new Gy("",new AS,this.qa());this.Ga(this.H);Jz(this.D,this.H,Xvb);this.F=new Gy("",new AS,this.qa());this.Ga(this.F);Jz(this.D,this.F,Wvb);this.R=new kCf(b,c);this.va(this.R);this.L=new Fz(this);this.va(this.L);this.ma=h}u(rCf,X_);rCf.prototype.Ca=function(){this.jb(Sx(oCf))};
rCf.prototype.Ia=function(){X_.prototype.Ia.call(this);this.H.Va(this.Fa("waffle-tables-popup-done"));this.F.Va(this.Fa("waffle-tables-popup-cancel"));var a=OAf(this.getTableRange(),this.C,1);a=tN(NH(a));a=Sx(qCf,{OP:a});this.Fa("waffle-tables-popup-header-message").appendChild(a);this.L.subscribe(Xvb,"action",this.xa).subscribe(Wvb,"action",this.V);a=this.Fa("waffle-assistant-table-canvas");var b=this.Fa("waffle-assistant-canvas-container");lCf(this.R,a,b,this.getTableRange(),this.C,this.J);a=this.Fa("waffle-tables-popup");
ix(a,"waffle-tables-popup-answers-enabled",this.ma);b=new tB(a,this.qa());this.va(b);uB(b);a.focus()};rCf.prototype.V=function(){this.dispatchEvent("Ed")};rCf.prototype.xa=function(){var a=NH(this.getTableRange());switch(this.C){case 0:a=Lm(a.top+1,a.left,a.top+a.height,a.left+a.width);break;case 1:a=Lm(a.top,a.left+1,a.top+a.height,a.left+a.width)}var b=this.J-1,c=this.getTableRange().ib();this.dispatchEvent(new jCf(new Mm(c,a),b,this.C));this.dispatchEvent("Ed")};
function sCf(a,b,c,d,e,f,h,k,l,n,q){zX.call(this,l,q);this.Wa=b;this.Za=c;this.Oa=d;this.$a=n;this.Ha=e;this.Pa=h;this.L=new Gy("",new AS,this.qa());this.Ga(this.L);this.ma=new Gy("",new AS,this.qa());this.Ga(this.ma);this.C=this.R=this.F=null;this.Ta=this.Za.L.C;this.Ba=Cy(xy(new wy,66));this.Ka=f;this.xa=new PW(f,"waffle-assistant-highlight-styled-border","waffle-assistant-highlight-styled-rect");this.va(this.xa);this.Qa=jg(l,4);this.D=null}u(sCf,zX);p=sCf.prototype;p.IG=m(!0);
p.Ca=function(){zX.prototype.Ca.call(this);AX(this).appendChild(Sx(PAf));qPe(this).appendChild(Sx(QAf))};
p.Ia=function(){var a=this;zX.prototype.Ia.call(this);var b=this.H.getPivotTableDef(),c=GQe(this.Pa,b);this.R=new OQe(c,b,this.Ta,this.$a);b=this.Fa("waffle-assistant-insert-pivottable-button");this.L.Va(b);wX(b,"Lis\u00e4\u00e4 Pivot-taulukko");b=this.Fa("waffle-assistant-zoom-button");this.ma.Va(b);wX(b,"Esikatsele Pivot-taulukko");this.getHandler().listen(this.L,"action",function(){tCf(a,35619)}).listen(this.ma,"action",this.FSa);this.Ov(this.Ld())};
p.WA=function(a){var b=this.qa();b.Je(this.Fa("waffle-assistant-answercard-interpret"),kg(this.H,3));this.C=b.Ca("CANVAS","waffle-pivottable-pivot-canvas");b.$h(this.C,!0);Sw(this.C,"Pivot-taulukon kanvas");var c=this.Fa("waffle-assistant-answercard-pivot-content");b.appendChild(c,this.C);b=this.H.getPivotTableDef();this.D=new NQe(c,this.Ka,this.Wa,this.Oa);this.D.H=b;c=this.Ld();this.D.F=c;this.getHandler().Bf(this.C,Sn,this.FSa).listen(this.C,"mousedown",this.ESa).Rc(this.D,"pivot_inserted",this.DRb);
PQe(this.R,this.C);a()};p.DRb=ba();p.Ov=function(a){zX.prototype.Ov.call(this,a);if(this.L&&this.Gb()){this.L.setVisible(!a);var b=this.qa().Fa("waffle-assistant-button-separator",qPe(this));P(b,!a)}this.F&&SQe(this.F,this.Ld());this.D&&(a=this.Ld(),this.D.F=a)};p.NB=function(){Sw(this.La(),"Ehdotettu Pivot-taulukko-"+kg(this.H,3))};p.pC=m("assistantPivotTableFeedback");p.xF=m(2632);p.wF=m(2631);
function tCf(a,b){dg(a.H,5)&&Ic(z(),"fewt")&&Tla(a.H.getPivotTableDef(),1);var c=new TQe(null,a.H.getPivotTableDef(),function(){a.dispatchEvent("close-sidebar");a.Ha.C(b,a.Ba)});PK.dispatchEvent(c)}p.FSa=function(){var a=this;this.Ha.C(35620,this.Ba);this.F=new RQe(this.R,kg(this.H,3),function(){tCf(a,35621)},function(){a.ESa()},this.qa());this.F.render();this.va(this.F);SQe(this.F,this.Ld())};p.ESa=function(){this.C&&this.C.focus()};p.zQ=function(){zX.prototype.zQ.call(this);RW(this.xa,qn(this.Qa))};
p.QK=function(){zX.prototype.QK.call(this);zW(this.xa)};function uCf(a,b,c,d,e,f,h,k,l){W_.call(this,1,f,e,l);this.H=d;this.Ba=b;this.Ea=c;this.F=h;this.Ha=k;this.J=Cy(xy(new wy,10));a=new DP(a,!0,!0);this.R=new CQe(a);this.D=null}u(uCf,W_);p=uCf.prototype;p.getTitle=m("Pivot-taulukko");p.D_=function(a){return 1==a};
p.KT=function(a){var b=D(a,1);switch(b){case 1:return new sCf(this.D,this.Ba,this.Ea,this.H,this.O,this.F,this.R,this.J,a,this.Ha,this.qa());default:throw Error("Unsupported recommendation type: "+b);}};p.CQ=function(a,b){a[0].getPivotTableDef()&&(this.D=b?b:null,W_.prototype.CQ.call(this,a,b))};p.I4=m(5);function vCf(){var a=null,b=new vp(function(){null!==a&&jp(a)});a=ip(function(){b.callback()});return b}function wCf(a,b,c){Wn.call(this);this.C=cmc(JN.getInstance(),a,b,c);this.D=Bp()}u(wCf,Wn);
wCf.prototype.update=function(a,b,c){var d=this,e=this.C.C;c&&e&&!Yc(c,function(f){return gxa(f,e.rect)},this)||!a&&e&&c&&1==c.length&&1==c[0].Wh()&&e.rect.contains(c[0])||(this.D.cancel(!0),a&&mHe(this.C),this.D=vCf(),xp(this.D,function(){return GHe(d.C,b,!0)}))};
function xCf(a,b,c){b=c||b;a=a.R0b;c='<div class="waffle-autovis-lightbox"><div class="waffle-autovis-lightbox-header"><div class="waffle-autovis-lightbox-buttons-wrapper">'+R(Nz({content:"LIS\u00c4\u00c4 KAAVIO",style:4,ad:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-insert waffle-autovis-lightbox-readonly-hidden"},b));c+=R(Nz({ad:"waffle-autovis-lightbox-close",content:Aw(""+R(jB({icon:"docs-icon-img docs-icon-close-white"},b))),style:4,title:"Sulje"},b));c+='</div></div><div class="waffle-autovis-lightbox-content"><div class="waffle-autovis-lightbox-content-inner">';
var d='aria-label="'+Cw("Edellinen kaavio");d+='"';c+=R(Nz({content:Aw("&#10094;"),style:4,ad:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-previous",attributes:Bw(d)},b));c+='<div class="goog-inline-block waffle-autovis-lightbox-container"></div>';d='aria-label="'+Cw("Seuraava kaavio");d+='"';c+=R(Nz({content:Aw("&#10095;"),style:4,ad:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-next",attributes:Bw(d)},b));c+='</div><div class="waffle-autovis-lightbox-page-count"><span class="waffle-autovis-lightbox-page-number"></span>/'+
R(a)+"</div></div></div>";return S(c)}function yCf(){return S('<div class="waffle-autovis-lightbox-chart"></div>')}function zCf(a,b,c,d,e){Q.call(this,e);this.F=a;this.D=b;this.V=c;this.R=d;this.H=[];this.C=new Oz("",this.qa());this.Ga(this.C);this.O=new Oz("",this.qa());this.Ga(this.O);this.L=new Oz("",this.qa());this.Ga(this.L);this.J=new Oz("",this.qa());this.Ga(this.J)}u(zCf,Q);p=zCf.prototype;p.Ca=function(){Q.prototype.Ca.call(this);this.jb(Sx(xCf,{R0b:this.F.length}))};
p.Ia=function(){Q.prototype.Ia.call(this);var a=GC.isEnabled();ACf(this,!a);a=this.Fa("waffle-autovis-lightbox-close");this.C.Va(a);a=this.Fa("waffle-autovis-lightbox-insert");this.O.Va(a);var b=this.Fa("waffle-autovis-lightbox-previous");this.L.Va(b);b=this.Fa("waffle-autovis-lightbox-next");this.J.Va(b);BCf(this);CCf(this,this.D,!1);this.getHandler().listen(document.body,"focusin",this.QRb).listen(this.La(),"keydown",this.RRb).listen(lo(),"resize",this.URb).listen(this.C,"action",this.close).listen(this.O,
"action",this.$ub).listen(this.L,"action",this.TRb).listen(this.J,"action",this.SRb);b=new tB(this.La(),this.qa());uB(b);this.va(b);a.focus()};function BCf(a){var b=a.Fa("waffle-autovis-lightbox-content"),c=a.Fa("waffle-autovis-lightbox-content-inner");a=a.Fa("waffle-autovis-lightbox-page-count");var d=ko();a=$v(a);var e=d.height-a.height-195,f=d.width-200;.75<e/f?(d=f,e=.75*f):d=e/.75;Xv(c,d,e);Xv(b,d,e+a.height+35)}function ACf(a,b){ix(a.La(),"waffle-autovis-lightbox-readonly",b)}
function CCf(a,b,c){c&&RK("Sivu "+(b+1+("/"+(a.F.length+"."))));a.H[b]?DCf(a,b):a.F[b]&&(Ic(z(),"fecpmr")?(c=a.F[b].createChartModel(),ECf(a,c,b)):tBf(a.F[b],function(d){if(!a.isDisposed()&&d){var e=d.Pe();e=e?e.toJSON():null;var f=ritz.charts.model.GvizChart.create();f.updateChartWrapperJsonString(d.toJSON());e&&f.updateDataTableJsonString(e);ECf(a,f,b)}},!0))}function ECf(a,b,c){var d=a.Fa("waffle-autovis-lightbox-container"),e=Sx(yCf);d.appendChild(e);a.H[c]=e;URe(b,e,a.V,a.R);DCf(a,c)}
function DCf(a,b){P(a.H[a.D],!1);P(a.H[b],!0);a.L.Na(0!=b);a.J.Na(b!=a.F.length-1);var c=a.Fa("waffle-autovis-lightbox-page-number");Eo(c,b+1);a.D=b}p.QRb=function(a){!Co(this.La(),a.target)&&a.relatedTarget&&a.relatedTarget.focus()};p.RRb=function(a){27==a.keyCode?this.close():37==a.keyCode||38==a.keyCode?0!=this.D&&CCf(this,this.D-1,!0):39!=a.keyCode&&40!=a.keyCode||FCf(this);a.stopPropagation()};
p.URb=function(){var a=this.Fa("waffle-autovis-lightbox-container");to(a);this.H=[];BCf(this);CCf(this,this.D,!0)};p.$ub=function(){this.close();wBf(this.F[this.D],2256)};p.TRb=function(){0!=this.D&&CCf(this,this.D-1,!0);0==this.D&&this.J.La().focus()};p.SRb=function(){FCf(this);this.D==this.F.length-1&&this.L.La().focus()};function FCf(a){a.D!=a.F.length-1&&CCf(a,a.D+1,!0)}p.close=function(){this.dispose()};p.vd=function(){Q.prototype.vd.call(this);var a=this.F[this.D];a&&a.La()&&a.La().focus()};
function GCf(a){var b=a.name;a='<div class="waffle-assistant-quicksum-entry" tabindex="0"><span class="waffle-assistant-quicksum-entry-name" title="'+T(a.title)+'">'+R(b)+'</span><span class="waffle-assistant-quicksum-entry-value"></span><span aria-label="';a+=Cw("Lis\u00e4\u00e4 kaava painamalla Enter.");return S(a+'"></span></div>')}function HCf(a,b){Q.call(this);this.C=a;this.D=b}u(HCf,Q);p=HCf.prototype;p.Ca=function(){var a=Sx(GCf,{name:this.C,title:this.D});this.jb(a)};
p.Ia=function(){Q.prototype.Ia.call(this);var a=this.Fa("waffle-assistant-quicksum-entry-name");wX(a);this.getHandler().listen(this.La(),"keypress",this.WQb);P(this.La(),!1)};p.getFunctionName=g("C");p.setValue=function(a){Eo(this.Fa("waffle-assistant-quicksum-entry-value"),a||"");P(this.La(),!!a)};p.isVisible=function(){return cw(this.La())};p.WQb=function(a){13==a.keyCode&&(a.stopPropagation(),a.preventDefault(),this.dispatchEvent(new Kn("insert",this)))};
function ICf(a,b,c,d,e){Q.call(this,e);this.Ha=a;this.Ea=b;this.L=c;this.O=d;this.D=a.C;this.ma=Cy(xy(new wy,17));this.V=Cy(xy(new wy,2));this.R=!1;this.F=[];this.C=this.J=null;this.H=[]}u(ICf,Q);
ICf.prototype.Ia=function(){Q.prototype.Ia.call(this);this.vf(new HCf(ritz_api.RitzModelApi.getLocalizedFunctionName("SUM"),"Summa"),0,!0);this.vf(new HCf(ritz_api.RitzModelApi.getLocalizedFunctionName("AVERAGE"),"Keskiarvo"),1,!0);this.vf(new HCf(ritz_api.RitzModelApi.getLocalizedFunctionName("MIN"),"Pienin"),2,!0);this.vf(new HCf(ritz_api.RitzModelApi.getLocalizedFunctionName("MAX"),"Suurin"),3,!0);this.vf(new HCf(ritz_api.RitzModelApi.getLocalizedFunctionName("COUNTA"),"Laske kaikki"),4,!0);this.C=
new AQe(this.La(),this.Ea,this.D,this.L);this.C.F=this.R;this.va(this.C);this.getHandler().listen(this,"insert",this.xa).listen(this.C,"formula_inserted",this.Ba)};
ICf.prototype.refresh=function(a){function b(l){return h&&null!=l?ritz_api.RitzModelApi.renderNumberAsFormattedString(l,k):null}if(GJ(this.D)){if(null==a){var c=JJ(this.D),d=oK(c);a=DJ(this.D);if(!Xc(d,c.rq,c)){P(this.La(),!1);return}c=[];for(var e=0;e<d.length;e++){var f=d[e];f=tPb(a,f.Ac(),f.yc(),f.Yc(),f.Xc());c.push(f)}a=c}d=[];this.F=[];for(c=0;c<a.length;c++)e=a[c],this.F.push(NH(e)),d.push(e.serialize());a=a[0].ib();this.J=null;a!=DJ(this.D)&&(this.J=(a=xJ(this.D,a))?a.Yd():null);if(d=ritz_api.RitzModelApi.quickSum(d)){P(this.La(),
!0);a=d.count;c=d.countNumberFormat;var h=1<d.numericCount,k=h?d.valueNumberFormat:null;this.xc(0).setValue(b(d.sum));this.xc(1).setValue(b(d.average));this.xc(2).setValue(b(d.min));this.xc(3).setValue(b(d.max));1<a?this.xc(4).setValue(ritz_api.RitzModelApi.renderNumberAsFormattedString(a,c)):P(this.La(),!1);if(this.C){this.C.H=[];this.H=[];for(d=0;d<this.rc();++d)a=this.xc(d),this.H.push(JCf(this,a.getFunctionName()));this.C.H=this.H}}else P(this.La(),!1)}else P(this.La(),!1)};
ICf.prototype.xa=function(a){var b=a.target;a=this.F[0];a=new bm(a.left,a.Yc());b=b.getFunctionName();b=JCf(this,b);a=new God(JJ(this.D),a,b);this.L.C(a);this.O.C(2624,this.V)};ICf.prototype.Ba=function(){this.O.C(2624,this.ma)};function JCf(a,b){var c=a.Ha.L.D,d=a.J;a=Tc(a.F,function(e){return tN(e,d)});return"="+b+"("+a.join(c)+")"}
function Y_(a,b,c,d,e,f,h){IX.call(this,h);this.Ta=a;this.Kb=b.C;this.He=IN(b);this.Ba=c;this.zd=d;this.J=f;this.Pd=e;this.Ka=new ICf(b,c,d,f,this.qa());this.Ga(this.Ka);this.L=null;this.Cb=this.tc=!1;this.fb=!0;this.Dd=gk();this.Pb=this.$a=this.Za=null;this.Ha=Cy(xy(new wy,10))}u(Y_,IX);p=Y_.prototype;p.Ca=function(){IX.prototype.Ca.call(this);this.jb(Sx(KCf,{VR:this.He}))};
p.Ia=function(){IX.prototype.Ia.call(this);var a=this.Fa("waffle-assistant-quicksum-panel");this.Ka.Va(a);a=this.Fa("waffle-assistant-spinner-container");this.ke.render(a);this.ke.setColor("#4285f4");a=this.Ta.C;this.getHandler().listen(this,"close-sidebar",this.Cra).listen(a,"recommender-load-started",this.nra).listen(a,"recommender-load-ended",this.mra).listen(a,"recommender-calc-started",this.Hqa).listen(a,"recommender-calc-ended",this.Gqa).listen(this.Fa("waffle-assistant-scroll-pane"),"scroll",
fIe(this.Rea,10,this));a=GC.isEnabled();this.Qea(!a)};p.resize=function(){var a=this.Fa("waffle-assistant-sidepane-content");a=$v(a).height;var b=this.Fa("waffle-assistant-spinner-container");Lv(b,"margin-top",a/2-16+"px");this.Rea()};p.DSa=ba();function LCf(a,b){var c=MCf(a);0!=c.length&&(Hf(a.L),c=c.filter(function(d){return d instanceof rBf}),b=c.indexOf(b),0<c.length&&-1!=b&&(a.L=new zCf(c,b,a.Pd,a.J,a.qa()),a.L.render(),a.va(a.L),ACf(a.L,a.Cb)))}
p.Qea=function(a){this.Cb=a;ix(this.La(),"waffle-assistant-readonly",a);var b=this.Ka;b.R=a;b.C&&(b.C.F=a);ix(b.La(),"waffle-assistant-quicksum-panel-readonly",a);this.L&&!this.L.isDisposed()&&ACf(this.L,a)};
p.setVisible=function(a){var b=this.isVisible();IX.prototype.setVisible.call(this,a);if(a&&!b){var c=tHe(this.Ta.C,a);c?(b=new dqe,M(b,1,Im(c,"r")),M(b,2,Im(c,"c")),M(b,3,c.Wh()),c=new Ej,cj(c,4,b),b=Cy(By(Dy(this.Ha),c))):b=this.Ha;this.$a=hk(this.Dd,"sett",!1,b);this.ke.setActive(!0);NCf(this)}a||OCf(this,!0)};p.nra=function(){this.isVisible()&&(OCf(this,!0),this.ke.setActive(!0))};p.mra=function(){this.isVisible()&&this.ke.setActive(!1)};
p.Hqa=function(a){this.isVisible()&&(this.J.C(2775,this.Ha),OCf(this,void 0,a.C,a.D),PCf(this)||this.ke.setActive(!0),NCf(this),this.fb=!1)};
p.Gqa=function(a){if(this.isVisible()){this.J.C(2776,this.Ha);var b=a.C;0<b.length&&(this.Za=hk(this.Dd,"serr"));OCf(this,!1);this.ke.setActive(!1);a=a.D;var c=ZV(this.Ta.C),d=this.V.C.getActiveGrid();c=!!c&&!!d&&c.ib()!=d.ib();d=ia(this.D);for(var e=d.next();!e.done;e=d.next()){e=e.value;for(var f=[],h=ia(b),k=h.next();!k.done;k=h.next()){k=k.value;var l=kg(k,1),n;if(!(n=!e.D_(l))&&(n=c)){a:switch(l){case 2:case 4:case 6:l=!1;break a;default:l=!0}n=!l}n||f.push(k)}0<f.length?e.CQ(f,a):e.DQ(!0)}b=
ia(b);for(a=b.next();!a.done;a=b.next())if(a=a.value,5==kg(a,1)){this.N8();this.Ea=D(a,12);this.H=(c=mW(a))?nAe(mn(c)):null;this.xa=D(a,11);QCf(this);a=this.H;c=!1;for(d=this.Oa.length-1;0<=d;d--)e=this.Oa[d],f=a,Xm(e,1)&&e.ib()==f.ib()&&EAf(uPb(e),uPb(f))&&EAf(wPb(e),wPb(f))&&(c=!0,this.Oa.splice(d,1));this.Oa.push(a);a=c;2!=this.Ea||a||RCf(this,!0)}b=MCf(this);0<b.length&&this.tc&&(b[b.length-1].ge=!0);this.tc=!1;NCf(this);SCf(this);this.Rea()}};
function NCf(a){var b=PCf(a),c=cw(a.Fa("waffle-assistant-quicksum-panel")),d=a.ke.Xb();b=b||c||d;c=a.Fa("waffle-assistant-empty-list");P(c,!b);P(a.ke.La(),b)}p.Pc=ba();p.Ixa=ba();p.Ld=g("Cb");p.Cra=ba();p.XLb=function(){this.Za&&(this.Za.complete(),this.Za=null);this.$a&&(this.$a.complete(),this.$a=null);this.Pb=La();this.fb||(this.J.C(2777,this.Ha),this.fb=!0)};
function TCf(){return S('<div class="waffle-assistant-title-bar"><div class="waffle-assistant-title-icon">'+R(coc({color:"#ffffff",iconSize:"21"}))+'</div><div class="waffle-assistant-title-text">'+R("Tutki")+"</div></div>")}
function KCf(a,b,c){b=c||b;a=a||{};c=S;var d=Aw('<div class="waffle-assistant-replaceable-title">'+TCf(null,b)+"</div>");var e=e=a||{};e=e.VR;var f='<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content" aria-live="polite">'+R(coc({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div class="waffle-assistant-empty-list-title">';f+='Tilastotiedot hetkess\u00e4</div><div class="waffle-assistant-empty-list-body">';f=(e?f+"Jos haluat n\u00e4hd\u00e4 vastauksia, muotoilun ja kaavioita yhdell\u00e4 klikkauksella, kokeile lis\u00e4t\u00e4 tietoja tai valitse eri solut laskentataulukostasi.":
f+"Jos haluat n\u00e4hd\u00e4 muotoilun ja kaavioita yhdell\u00e4 klikkauksella, kokeile lis\u00e4t\u00e4 tietoja tai valitse eri solut laskentataulukostasi.")+'</div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Lis\u00e4tietoja';f+='</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">';f+="Kokeile";f+="</a></div></div></div>";e=S(f);
e=S('<div class="waffle-sidebar-tables-bar" style="display: none"><div class="waffle-assistant-sidepane-tables-range"></div><div class="waffle-assistant-tables-edit-range-button">Muokkaa</div></div><div class="waffle-assistant-scroll-pane"><div class="waffle-assistant-scroll-pane-content"><div class="waffle-assistant-scroll-pane-feature-content">'+(e+'<div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-quicksum-panel" style="display: none"></div><div class="waffle-assistant-features"></div></div><div class="waffle-assistant-expanded-panel" style="display: none"></div></div></div>'));
return c(R(fY(xw({title:d,Ek:Aw(""+e),id:"autovis",Zv:"waffle-assistant-sidepanel",Zha:"waffle-assistant-title",JT:"waffle-assistant-sidepane-content"},a),b)))}
function UCf(a,b,c,d,e,f,h,k,l,n){X_.call(this,a,Rvb,d,e,f);var q=this;this.Ha=n;this.Za=b;this.Ea=d;this.Bb=e;this.Cb=f;a=NH(d);this.H=tN(a);this.L=d.ib();this.Qa=new kCf(b,c);this.va(this.Qa);this.F=this.D=null;this.ma=h;this.R=yB(new xB);this.va(this.R);this.Ba=new Gy("",new AS,this.qa());this.Ga(this.Ba);Jz(this.R,this.Ba,Tvb);this.xa=new Gy("",new AS,this.qa());this.Ga(this.xa);Jz(this.R,this.xa,Rvb);b=this.O.C.C.Yd();this.V=new TX(this.Za,function(r,w,x){VCf(q,r,w,x)},!1,"esim. A2:D5",!0,b,
this.qa());this.Ga(this.V);this.Oa=null;this.Pa=new Fz(this);this.va(this.Pa);this.$a=k;this.fb=l}u(UCf,X_);p=UCf.prototype;p.Ca=function(){this.jb(Sx(nCf))};
p.Ia=function(){X_.prototype.Ia.call(this);this.Ba.Va(this.Fa("waffle-tables-popup-done"));this.xa.Va(this.Fa("waffle-tables-popup-cancel"));this.V.render(this.Fa("waffle-assistant-tables-data-range-wrapper"));var a=this.Fa("waffle-range-selection-input");Pw(a,"labelledby","waffle-assistant-tables-data-range-label");this.getHandler().listen(a,"keydown",this.HRb).listen(a,"keyup",this.IRb).listen(a,"focusout",this.OFb).listen(this.O.C,"qa",this.KRb).listen(this.V,"change",this.JRb);this.Pa.subscribe(Tvb,
"action",this.LRb).subscribe(Rvb,"action",this.Gmb);WCf(this);a=this.Fa("waffle-tables-popup");ix(a,"waffle-tables-popup-answers-enabled",this.fb);var b=new tB(a,this.qa());this.va(b);uB(b);a.focus()};p.Ja=function(){Hf(this.Oa);X_.prototype.Ja.call(this)};function VCf(a,b,c,d){TW(a.$a,null,b,c,d,!1,void 0,function(e){a.Oa=e})}
p.KRb=function(){for(var a=this.O.C,b=!0,c=ia(yYb(a)),d=c.next();!d.done;d=c.next())if((d=d.value)&&d.ib()==this.L){b=!1;break}b&&"number"===typeof CJ(a)&&(this.L=CJ(a),XCf(this,this.L));YCf(this)};function ZCf(a){var b=a.Fa("waffle-assistant-table-canvas"),c=a.Fa("waffle-assistant-canvas-container");lCf(a.Qa,b,c,a.getTableRange(),a.C,a.J)}p.Gmb=function(){this.dispatchEvent("Ed")};
p.LRb=function(){var a=!Njc.test(this.H);P(this.bb("waffle-assistant-tables-range-error"),a);ix(this.Fa("waffle-assistant-tables-data-range-wrapper"),"waffle-assistant-tables-range-error-input",a);if(!a){a=this.Bb!=this.J||this.Cb!=this.C;var b=!this.Ea.equals(this.getTableRange()),c=this.Ea.ib()!=this.getTableRange().ib();if(a||b)a&&this.ma.C(35506),b&&this.ma.C(35507),c&&this.ma.C(35723),this.dispatchEvent(new jCf(pGe(this.getTableRange()),this.J,this.C,c));this.dispatchEvent("Ed")}};
function WCf(a){var b=a.Fa("waffle-range-selection-input"),c=NH(a.Ea);a.H=tN(c);b.value=a.H;YCf(a);$Cf(a);ZCf(a)}p.Sea=function(a,b,c){X_.prototype.Sea.call(this,a,b,c);ZCf(this)};
function aDf(a){var b=KJ(a.O.C,a.L),c=b.dc(),d=Rjc(a.H,b),e=null!=d;if(e&&(b=z_b(b,d),e=Km(b))){b=MH(b,c);var f=uPb(b);c=wPb(b);b=b.ib();d=Zm(f,1);f=Xm(f,2)?Zm(f,2):ritz_api.RitzModelApi.getNumberOfRows(b);var h=Zm(c,1);c=Xm(c,2)?Zm(c,2):ritz_api.RitzModelApi.getNumberOfColumns(b);c=tPb(b,d,h,f,c);a.Sea(c,bDf(a,c),a.C);YCf(a);$Cf(a)}P(a.bb("waffle-assistant-tables-range-error"),!e)}function bDf(a,b){b=cDf(b,a.C);return a.J>b?b:a.J}
function cDf(a,b){a=0==b?a.Yc()-a.Ac():a.Xc()-a.yc();return 0==a?3:Math.min(a-1,3)}
function YCf(a){if(a.Ha){P(Ko(a.qa(),"waffle-assistant-tables-data-range-label"),!1);Hf(a.F);a.F=new vX(void 0,qU.getInstance());a.F.setContent("Tietoalue");a.Ga(a.F);Jz(a.R,a.F,Uvb);a.F.render(a.Fa("waffle-assistant-tables-edit-sheet-button"));a.getHandler().listen(a.F,"action",a.SDb);for(var b=0,c=ia(yYb(a.O.C)),d=c.next();!d.done;d=c.next())if(d=d.value)d.ib()===a.L&&(b=a.F.hh()),a.F.Sc(new Ky(d.Yd(),d.ib()));a.F.xf(b)}}
function $Cf(a){Hf(a.D);a.D=new vX(void 0,qU.getInstance());a.Ga(a.D);Jz(a.R,a.D,Svb);a.D.render(a.Fa("waffle-assistant-tables-edit-headers-button"));a.getHandler().listen(a.D,"action",a.Wtb);for(var b=cDf(a.getTableRange(),0),c=0;c<=b;c++){var d=(new uA("{NUM_HEADER_RECORDS,plural, =0{Ei rivej\u00e4}=1{1\u00a0rivi}other{#\u00a0rivi\u00e4}}")).format({NUM_HEADER_RECORDS:c});a.D.Sc(new Ky(d))}c=cDf(a.getTableRange(),1);for(d=0;d<=c;d++){var e=(new uA("{NUM_HEADER_RECORDS,plural, =0{Ei sarakkeita}=1{1\u00a0sarake}other{#\u00a0saraketta}}")).format({NUM_HEADER_RECORDS:d});
a.D.Sc(new Ky(e))}c=a.J;a.D.xf(0==a.C?c:c+b+1);a.D.setContent("Yl\u00e4tunnisteet")}p.OFb=function(){var a=this.Fa("waffle-range-selection-input");this.H!=a.value&&(this.H=a.value,aDf(this))};p.JRb=function(){var a=this.V.getValue();this.H=a;var b=this.Fa("waffle-range-selection-input");b.value=a;b.select();aDf(this)};p.SDb=function(){var a=this.F.getValue();a!=this.L&&(this.L=a,XCf(this,this.L));aDf(this)};
function XCf(a,b){if(a.Ha){var c=KJ(a.O.C,b),d=zm(oK(c));ritz_api.TablesApi.getTables(ln(jn(d,b)),function(e){if(e.length){var f=e[0];e=f.getDimensionTableAccessor().getHeaderRange();var h=pn(JT(e));e=f.getDimensionTableAccessor().getDimensionTagName();h=Im(h,0==e?"r":"c");f=NH(FAf(f.getTableRange()))}else f=d,e=h=0;a.C=e;a.J=h;e=tN(f);a.H=e;e=a.Fa("waffle-range-selection-input");e.value=a.H;e.select();aDf(a)})}}
p.HRb=function(a){var b=this.Fa("waffle-range-selection-input");switch(a.keyCode){case 13:a.stopPropagation();a.preventDefault();this.H=b.value;aDf(this);Tvb.wb();break;case 27:a.stopPropagation(),a.preventDefault(),WCf(this),Rvb.wb()}};p.IRb=function(){this.H=this.Fa("waffle-range-selection-input").value;aDf(this)};p.Wtb=function(){var a=this.D.Xh(),b=cDf(this.getTableRange(),0);this.Sea(this.getTableRange(),a-(0==(a>b?1:0)?0:b+1),a>b?1:0)};
function dDf(a,b,c,d,e,f,h,k,l,n,q,r){Y_.call(this,a,b,c,e,d,f,r);this.yd=n;this.Qc=h;this.V=b;this.Wa=new Q(this.qa());this.Ga(this.Wa);this.R=new WQe(q);this.va(this.R);this.D=[];this.F=null;this.Qa=new Oz("",r,4);ky(this.Qa,2,!1);this.Ga(this.Qa);this.Vc=k;this.Lc=l;this.H=null;this.Ea=0;this.xa=null;this.Bb=new Gy("",new AS,this.qa());this.Ga(this.Bb);this.fc=new Q(this.qa());this.Ga(this.fc);this.Dc=yB(new xB);this.va(this.Dc);Jz(this.Dc,this.Bb,Vvb);this.ma=this.O=null;this.Oa=[]}u(dDf,Y_);
p=dDf.prototype;
p.Ia=function(){var a=this;Y_.prototype.Ia.call(this);this.Wa.Va(this.Fa("waffle-assistant-expanded-panel"));wX(this.C.La(),"Sulje");this.fc.Va(this.Fa("waffle-assistant-sidepane-tables-range"));QCf(this);this.Bb.Va(this.Fa("waffle-assistant-tables-edit-range-button"));if(IN(this.V)){var b=new PBf(this.Qc,this.Ba,this.Kb,this.zd,this.J,this.R,this.V,this.Lc,this.yd,this.qa());this.Ga(b);this.D.push(b)}b=new iCf(this.J,this.R,this.qa());this.Ga(b);this.D.push(b);Ic(z(),"feedvs")&&(b=new ZBf(this.J,
this.R,this.Ba,this.qa()),this.Ga(b),this.D.push(b));b=new uCf(this.Qc,this.Kb,this.V,this.zd,this.J,this.R,this.Ba,this.yd,this.qa());this.Ga(b);this.D.push(b);b=new NBf(this.Kb,this.Ba,this.Pd,this.J,this.R,this.qa());this.Ga(b);this.D.push(b);var c=this.Fa("waffle-assistant-features");Qc(this.D,function(d){d.render(c);a.Wa.Ga(d.C,!0)});this.Qa.Va(this.Fa("waffle-assistant-empty-list-learn-more"));this.getHandler().listen(this.Qa,"action",this.uRb).listen(this,"Ed",this.N8).listen(this,"Dd",this.vRb);
eDf(this)};p.vRb=function(){var a=fDf(this);a&&(a.Qa=!0)};p.uRb=function(){(ct(),Su).wb($Ld)};function SCf(a){Qc(a.D,function(b){IBf(b)})}function OCf(a,b,c,d){Qc(a.D,function(e){e.DQ(b,c,d)})}function PCf(a){return!!Yc(a.D,function(b){return b.Nra()})}p.Rea=function(){var a=this,b=this.Fa("waffle-assistant-scroll-pane").scrollTop+$v(this.Fa("waffle-assistant-sidepane-content")).height;Qc(this.D,function(c){a.F&&a.F!=c||(c instanceof NBf&&a.getHandler().Rc(c,"yd",a.XLb),b=c.J4(b))})};
function MCf(a){if(a.F)return a.F.C.C;var b=[];Qc(a.D,function(c){ld(b,HBf(c))});return b}p.Qea=function(a){Y_.prototype.Qea.call(this,a);eDf(this)};p.DSa=function(a){Qc(this.D,function(b){b.ASa(a)})};p.Ixa=function(){var a=this.Fa("waffle-assistant-replaceable-title"),b=this.Fa("waffle-assistant-title");Zv(b,$v(a).height)};
p.Pc=function(){var a=this,b=this.Fa("waffle-assistant-scroll-pane-feature-content"),c=this.Fa("waffle-assistant-replaceable-title"),d=this.Wa.La();if(this.F)this.F.C.setVisible(!1),this.F.setActive(!1),this.F=null,P(d,!1),P(b,!0),Qx(c,TCf),Qw(c,"label"),this.resize(),RK("Tutki-toiminto avattu");else if(this.F=Yc(this.D,function(e){return e.Xb()}))P(b,!1),P(d,!0),this.F.C.setVisible(!0),JBf(this.F,c),Sw(c,this.F.getTitle()),b="Osio "+(this.F.getTitle()+" laajennettu."),RK(b);this.Ixa();b=new Qp(function(){var e=
hC.uy();e&&e.dispatchEvent("resize");a.Rea()},300);this.va(b);b.start()};p.setVisible=function(a){var b=this.isVisible();Y_.prototype.setVisible.call(this,a);a&&!b&&gDf(this,!0);a||this.R.clear()};p.Cra=function(){Y_.prototype.Cra.call(this);this.F&&this.Pc();this.N8()};p.nra=function(){Y_.prototype.nra.call(this);gDf(this,!0)};p.mra=function(){Y_.prototype.mra.call(this);gDf(this,!1)};p.Hqa=function(a){Y_.prototype.Hqa.call(this,a);gDf(this,!0,a.C)};
p.Gqa=function(a){Y_.prototype.Gqa.call(this,a);gDf(this,!1)};function hDf(a,b){var c=fDf(a);if(b){var d=Ic(z(),"feenas");a.O=new UCf(a.V,a.Ba,a.Vc,a.H,a.Ea,a.xa,a.J,a.Lc,null!=c&&c.Xb(),d);a.Ga(a.O);a.O.render(a.getElement())}else a.O&&(a.removeChild(a.O,!0),Hf(a.O),a.O=null);c&&SBf(c,b)}function RCf(a,b){if(1!=a.xa){var c=fDf(a);b?(a.ma=new rCf(a.V,a.Ba,a.Vc,a.H,a.Ea,a.xa,null!=c&&c.Xb()),a.Ga(a.ma),a.ma.render(a.getElement())):a.ma&&(a.removeChild(a.ma,!0),Hf(a.ma),a.ma=null);c&&SBf(c,b)}}
function eDf(a){Qc(a.D,function(b){b.EQ(a.Ld())})}function fDf(a){return(a=Yc(a.D,function(b){return b instanceof PBf}))&&a}function gDf(a,b,c){Qc(a.D,function(d){d.Pn(b,c)});b&&(a.H=null,a.Ea=0,a.xa=null,a.N8(),QCf(a))}
function QCf(a){var b=a.Fa("waffle-sidebar-tables-bar"),c=a.Fa("waffle-assistant-scroll-pane");var d=null;var e=Ic(z(),"feenas"),f=ZV(a.Ta.C);if(a.H||e&&f){if(a.H){var h=NH(a.H);f=a.H.ib();e&&(d=xJ(a.V.C,f).Yd())}else h=f.Ic().C,d=f.Yd(),a.H=MH(h,f.ib()),a.xa=0;d=tN(h,d);d=Sx(pCf,{EB:d});a=a.fc.Hb();to(a);a.appendChild(d);P(b,!0);ex(c,"waffle-assistant-tables-scroll-pane")}else P(b,!1),gx(c,"waffle-assistant-tables-scroll-pane")}p.N8=function(){hDf(this,!1);RCf(this,!1)};
function iDf(a,b,c){a=EFd(a.J);switch(b){case 4:case 5:case 6:case 7:a=ia(a);for(var d=a.next();!d.done;d=a.next())if(d=d.value.pv(),d.getType()===b)return kg(d,2)}return c}function jDf(a){switch(a){case 11:case 12:case 13:case 14:case 15:case 16:case 8:return 1;case 1:case 2:return 2;case 4:return 3;case 3:return 4;case 5:return 5;case 6:return 6;case 7:return 7;default:return 0}}
function Z_(a,b,c,d){b=void 0===b?!0:b;var e=new gh;if(b){var f=new ug;E(e,2,1);c&&d?(f.setType(c),f.setPattern(d)):f.setType(jDf(a));E(e,3,f)}c=new xq;d=2;b&&(d|=8,E(c,5,e));E(c,2,d);c.setType(a);return c}function kDf(a,b){a=ritz_api.TablesApi.getCurrentlyDetectedTables(ln(TLe(a.dc())));return a.length?Yc(a,function(c){return pn(JT(c.getTableRange())).intersects(b)}):null}function lDf(a,b,c,d,e,f){A.call(this);this.H=a;this.L=b;this.F=c;this.J=d;this.D=e;this.C=f}u(lDf,A);
function mDf(a,b,c,d){var e=null==c?null:D(c,1),f=null==c?null:c.getPattern();f=null==c?null:Z_(nDf(e,f),!0,e,iDf(a.L,e,c.getPattern()));var h=null==b?null:b.getType();h=null!=h&&0!=h;c=null!=c;if(!h&&!c)return Z_(oDf(a,d));if(h)switch(h=c?f:Z_(oDf(a,d)),D(b,4)){case "number":return c?f:Z_(oDf(a,d));case "price":if(c&&4==e)break;return Z_(3);case "datetime":if(!c)return Z_(5,!1);switch(e){case 5:case 6:case 7:return f;default:return Z_(5,!1)}case "email address":return Z_(9);case "location":return Ic(z(),
"felct")?Z_(11):h;case "address":return Ic(z(),"feact")?Z_(12):h;case "phone number":return Ic(z(),"fepnct")?Z_(13):h;case "company":return Ic(z(),"fecctp")?Z_(14):h;case "famous people":return Ic(z(),"fepct")?Z_(15):h;case "stock":return Ic(z(),"fesct")?Z_(16):h;default:return h}return f}
function oDf(a,b){var c=0,d=0,e=0,f=0,h=0,k=0,l=0,n=a.J.rect,q=a.F.rect;for(n=n.top+n.height;n<q.top+q.height&&l<a.D;n++){var r=a.H.Kg(n,b);l++;if(!yEd(r)&&(k++,!BZb(r))){var w=r.getNumericValue();w&&(c++,Math.floor(w)==w&&h++,(w=zEd(r))&&4===w.getType()?d++:ritz_api.RitzModelApi.isPercentageNumberFormat(r.C)?e++:r.isAnyDateOrTimeFormat()&&f++)}}b=d/k;if(b>a.C&&1>b)return 3;e/=k;if(e>a.C&&1>e)return 4;if(.1<b||.1<e||.1<f/k)return 0;f=h/k;if(f>a.C&&1>f)return 1;c/=k;return c>a.C&&1>c?2:0}
function nDf(a,b){switch(a){case 1:return 8;case 2:return b.includes(".0")?2:1;case 3:return 4;case 4:return 3;case 5:return 5;case 6:return 6;case 7:return 7;case 8:return 2;default:return 0}}function pDf(a){this.R=a;this.Ka=!1;this.O=[];this.L=[];this.V=[];this.Qa=[];this.Ha=[];this.Ea=[];this.xa=[];this.Wa=[];this.ma=[];this.Ta=[];this.C=[];this.F=[];this.J=[];this.H=this.D=this.Oa=this.Pa=null;this.Ba=[]}pDf.prototype.getTableRange=g("Oa");function qDf(a,b){a.J.push(b)}
function rDf(a,b,c){a.O.push(b);a.L.push(c)}function sDf(a,b,c){a.J[c]=b}function tDf(a,b,c,d,e,f,h,k){A.call(this);this.H=a;this.O=b;this.R=d;this.C=e;this.Ha=h;this.Ea=k;this.D=oW(this.O);this.V=new Qp(this.xa,void 0,this);this.va(this.V);this.J=[];this.ma=new Qp(this.Ba,void 0,this);this.va(this.ma);this.F=[];this.L=[];uDf(this,f)}u(tDf,A);
tDf.prototype.xa=function(){if(this.J.length&&this.L.length){var a=XK(this.O);a&&(ritz_api.RitzModelApi.applyAnomalySetCellMutations(a.Jo().ib(),this.J),iQ(a,this.L));this.J=[];this.L=[]}};function vDf(){return"MERGED"===Lc(z(),"fdpfs")&&Ic(z(),"fects")&&Ic(z(),"fecis")&&Ic(z(),"fecad")}
function wDf(a,b,c,d){if(!vDf()||!c||!d)return null;var e=AN(a.H);if(!e)return null;var f=[],h=[],k=d.rect,l=ritz_api.TablesApi.getCurrentlyDetectedTables(ln(TLe(e.dc())));if(!Yc(l,function(L){L=pn(JT(L.getTableRange()));if(k.intersects(L))return!1;for(var X=k.left;X<k.left+k.width;X++)if(L.Ru("c",X))return!0;return!1})){var n=a.C.L,q=a.C.O;l=[];for(var r=0;r<n.length;r++){var w=n[r],x=q[r],B=x-k.left;0<=B&&x<k.left+k.width&&(l[B]=w)}c=mn(JT(c.getDimensionTableAccessor().getHeaderRange()));a=new lDf(e,
a.H.F,d,c,a.Ha,a.Ea);for(c=k.left;c<k.left+k.width;c++)ritz_api.RitzModelApi.getColumnType(e.dc(),c)||(n=c-k.left,n=mDf(a,l[n],b[n],c),0!=n.getType()&&(h.push(n),f.push(new Mm(d.C,Lm(0,c,e.gg(),c+1)))))}return{a9a:h,$8a:f}}
function xDf(a,b,c){if(c&&c.O){var d=AN(a.H);if(d)if(c=c.O,c instanceof ZTc)c.H.ib()===d.dc()&&uDf(a,b,c.rk());else if(c instanceof JUc){b=null;d=c.ib();if(d!==a.D){if(b=yDf(a,d),!b)return}else b=a.C;if("c"==c.F){var e=c.H;if(1==e.length&&Zm(e[0],1)+1==Zm(e[0],2)){var f=Zm(e[0],1);c=c.D.Nm(3,DAf);e=b.O.findIndex(function(h){return h===f});-1==e?rDf(b,f,c):b.L[e]=c;d!=a.D&&a.R.set(d,b)}}}}}function yDf(a,b){var c=null;b&&(c=a.R.has(b)?a.R.get(b):new pDf(!1));return c}
function uDf(a,b,c){if(Ic(z(),"fecad")){var d=AN(a.H);if(d){var e=c?[c]:ritz_api.RitzModelApi.getWorkbookRangesForSheet(a.D,12);c=new Mk;var f=[],h={};e=ia(e);for(var k=e.next();!k.done;h={rZ:h.rZ,o7:h.o7},k=e.next()){var l=k.value,n=c.Tc(uSa.Aa(),ritz_api.RitzModelApi.getWorkbookRangePropertiesDeltaProtoById(l));if(k=ritz_api.RitzModelApi.getWorkbookRangeById(l,!1))if(k=c.Tc(Jg.Aa(),k),k.ib()===d.dc())if(kg(k,2)===kg(k,3)||kg(k,4)===kg(k,5))f.push(l);else if(l=new um(kg(k,2),kg(k,4),kg(k,3),kg(k,
5)),h.rZ=new Mm(a.D,l),!zDf(a,k)){l=D(n,11);n=kg(D(n,11),4);var q=ritz_api.RitzModelApi.getColumnType(k.ib(),k.yc());ADf(q,n)&&BDf(a,k,!1);q=a.C.C.findIndex(function(r){return function(w){return w.equals(r.rZ)}}(h));-1==q?(a.C.C.push(h.rZ),a.C.F.push(n),qDf(a.C,d.Kg(kg(k,2),kg(k,4)).getDisplayValue()),b.push(h.rZ)):(a.C.F[q]=n,sDf(a.C,d.Kg(kg(k,2),kg(k,4)).getDisplayValue(),q));h.o7=kg(k,4);k=a.C.O.findIndex(function(r){return function(w){return w===r.o7}}(h));-1==k?rDf(a.C,h.o7,l):a.C.L[k]=l}}f&&
CDf(a,f)}}}function DDf(a,b,c){if(a.D&&c){c=ia(c);for(var d=c.next();!d.done;d=c.next()){var e=a,f=b;d=d.value;if(!EDf(e,f,d)){for(var h=[],k=e.C.C,l=e.C.F,n=e.C.J,q=[],r=[],w=[],x=0;x<k.length;x++){var B=k[x].rect;B.intersects(d)&&f.Kg(B.top,B.left).getDisplayValue()!==n[x]?(BDf(e,kn(k[x]),!0),FDf(e,h,k[x].rect)):(q.push(k[x]),r.push(l[x]),w.push(n[x]))}e.C.C=q;e.C.F=r;e.C.J=w;CDf(e,h)}}}}
function ADf(a,b){if(null===a)return!1;a=(new Mk).Tc(xq.Aa(),a);a=GDf(a.getType());return b.toUpperCase()===a}
function EDf(a,b,c){if(Bm(c))return!1;var d=a.C.C,e=a.C.F,f=a.C.J,h=Zc(d,function(X){return null!=ym(X.rect,c)});if(-1==h)return!1;b=b.dc();var k=ritz_api.RitzModelApi.getColumnType(b,d[h].rect.left);if(ADf(k,e[h]))return!1;k=[];var l=[],n=[],q=[];h=[];for(var r=[],w=0;w<d.length;w++)if(d[w].rect.intersects(c)){var x=kn(d[w]),B=BDf(a,x,!0,!1),L=d[w].rect;FDf(a,q,L);h.push(L);B&&r.push(x)}else k.push(d[w]),l.push(e[w]),n.push(f[w]);a.C.C=k;a.C.F=l;a.C.J=n;CDf(a,q);0<r.length&&ritz_api.RitzModelApi.applyAnomalySetCellMutations(b,
r.map(function(X){return HDf(!0,X)}));(a=XK(a.O))&&iQ(a,h);return!0}function CDf(a,b){b.length&&(a.F=a.F.concat(b),a.ma.start(100))}tDf.prototype.Ba=function(){this.F.length&&(ritz_api.RitzModelApi.applyDeleteWorkbookRangeMutations(this.F,12),this.F=[])};function FDf(a,b,c){if(a=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(a.D,c.top,c.left,c.top+c.height,c.left+c.width,12,!1))for(a=ia(a),c=a.next();!c.done;c=a.next())b.push(c.value)}
function BDf(a,b,c,d){d=void 0===d?!0:d;if(!vDf()||!ritz_api.RitzModelApi.getColumnType(b.ib(),b.yc())||zDf(a,b))return!1;var e=ritz_api.RitzModelApi.getCellAtNoFilter(b.ib(),kg(b,2),kg(b,4));if(!e||ritz_api.RitzModelApi.isDataValid(e)==c)return!1;if(!d)return!0;c=HDf(c,b);a.J.push(c);a.L.push(pn(b));a.V.start(100);return!0}function HDf(a,b){var c=new Mk,d=new Oq;E(d,13,a);E(d,2,1024);a=new ps;E(a,1,b);E(a,2,d);return c.serialize(a)}
function zDf(a,b){a=AN(a.H);if(!a||b.ib()!==a.dc())return!1;if(a=kDf(a,pn(TLe(a.dc()))))if(a=JT(a.getDimensionTableAccessor().getHeaderRange()),qya(a,b))return!0;return!1}function GDf(a){switch(a){case 11:return"LOCATION";case 12:return"ADDRESS";case 13:return"PHONE NUMBER";case 14:return"COMPANY";case 15:return"FAMOUS PEOPLE";case 16:return"STOCK";case 7:return"DATETIME";case 9:return"EMAIL ADDRESS";default:return"OTHER"}}
function IDf(a,b,c,d){A.call(this);this.H=a;this.D=b;this.J=c;this.cb=d||null}u(IDf,$T);
IDf.prototype.C=function(a){var b=this,c=[],d=new Ky("Ehdotus on virheellinen",null,this.cb);d.Kc("apps-menuitem");c.push(d);Jz(a,d,this.H,void 0,function(){return JDf(b,"Ehdotus on virheellinen")},this.D);d=new Ky("Ehdotus ei ole kriittinen",null,this.cb);d.Kc("apps-menuitem");c.push(d);Jz(a,d,this.H,void 0,function(){return JDf(b,"Ehdotus ei ole kriittinen")},this.D);d=new Ky("Muu",null,this.cb);d.Kc("apps-menuitem");c.push(d);Jz(a,d,this.H,void 0,function(){return JDf(b,"Muu")},this.D);c.push(null);
d=Sx(kWe);d=new Ky(d,null,this.cb);d.Kc("apps-menuitem");c.push(d);Jz(a,d,this.H,void 0,function(){return JDf(b,"Muu")},this.D);return c};function JDf(a,b){return new RHe({description:b},a.J,a.D)}var KDf={Hgc:"anomaly",z1a:"column-type",J3a:"remove-duplicates",TDc:"number-format",O4a:"trim-whitespace"};
function $_(a,b,c,d){Q.call(this,d);this.Pa=a;this.D=XK(b);this.O=c;this.L=new PW(b,"waffle-assistant-highlight-styled-border","waffle-assistant-highlight-styled-rect");this.va(this.L);this.ma=new PW(b,"waffle-assistant-mouseover-highlight-styled-border","waffle-assistant-mouseover-highlight-styled-rect");this.va(this.ma);var e=yB(new xB);this.va(e);this.Oa=new $Hd(function(){return e},this.qa());this.va(this.Oa);this.Wa=Cy(xy(new wy,76));this.C=new kS(this.qa());this.Ga(this.C);this.H=null;this.V=
{};this.Za=new Fz(this);this.va(this.Za);this.R=this.J=!1;this.F=null}u($_,Q);p=$_.prototype;p.Ia=function(){var a=this;Q.prototype.Ia.call(this);this.C.Va(this.Fa("waffle-assistant-card-checkbox"));this.C.Zb(this.isChecked());var b=this.La();this.getHandler().listen(this.C,"change",this.RJ).listen(b,"mouseenter",this.yD).listen(b,"mouseleave",this.xUa).listen(b,"click",function(){a.C.Zb(!a.C.isChecked());a.C.dispatchEvent("change")}).listen(b,"keydown",this.v_b);LDf(this)};
p.Ja=function(){Q.prototype.Ja.call(this);this.pB()};p.RJ=function(){this.J=!this.J;this.C.Zb(this.J);this.pB();this.J?(hy(this.C,"waffle-assistant-card-unchecked-hovered-checkbox"),this.AH(),this.R||RW(this.L,this.O)):zW(this.L);this.dispatchEvent("waffle-assistant-card-checked")};p.yD=function(){this.R=!0;zW(this.L);RW(this.ma,this.O);this.pB();this.AH();this.C.Zb(!0);this.J||this.C.Kc("waffle-assistant-card-unchecked-hovered-checkbox");this.F&&this.F.setVisible(!0)};
p.xUa=function(){this.R=!1;this.J?RW(this.L,this.O):(this.C.Zb(!1),this.pB());hy(this.C,"waffle-assistant-card-unchecked-hovered-checkbox");zW(this.ma);this.F&&!this.F.Ob().isVisible()&&this.F.setVisible(!1);this.La().blur()};p.v_b=function(a){if(32==a.keyCode||13==a.keyCode)this.RJ(),a.stopPropagation()};
function LDf(a){if(Ic(z(),"fedpsf")&&!a.F){a.F=new LWe(a.qa());a.Ga(a.F);var b=new IDf(eob,a.Wa,a.V,a.qa());bId(a.Oa,a.F.Ob(),[b]);b=a.Fa("waffle-assistant-card-feedback");a.F.render(b);a.F.setVisible(!1);a.getHandler().listen(a.F.Ob(),"afterhide",function(){a.F.setVisible(!1)})}}function MDf(a){return a.O.map(function(b){return b.rect})}p.isChecked=g("J");function a0(a){return a.O[0]}function NDf(a,b){a.R=b;a.F&&(b?a.F.setVisible(!0):b||a.F.Ob().isVisible()||a.F.setVisible(!1))}
p.Zb=function(a){a!=this.isChecked()&&this.RJ()};function ODf(a,b,c,d,e,f){c.sort(function(h,k){return h.rect.top-k.rect.top});$_.call(this,a,b,c,f);this.xa=d;this.Ba=this.O.map(function(h){return tN(h.rect)});this.Ea=e}u(ODf,$_);p=ODf.prototype;p.a5=m("anomaly");p.Ca=function(){var a=Sx(JAf,{vL:this.Ba,Y_:this.xa.toUpperCase(),p8a:this.Ea});this.jb(a);a={};this.V=(a.recommendationCategory="CATEGORICAL_ANOMALY",a.recommendationRange=this.Ba.join(","),a)};
p.Ia=function(){$_.prototype.Ia.call(this);var a=this.Fa("jfk-textinput"),b=this.La();this.getHandler().listen(a,["mousedown","click","mouseup","keydown"],function(c){return void c.stopPropagation()}).listen(a,"input",this.n_b).listen(b,"click",function(){return a.focus()})};p.RJ=function(){var a=PDf(this);a&&!a.length?(this.C.Zb(!1),this.C.Kc("waffle-assistant-card-checkbox-disabled")):($_.prototype.RJ.call(this),hy(this.C,"waffle-assistant-card-checkbox-disabled"))};
p.yD=function(){$_.prototype.yD.call(this);var a=this.C;PDf(this)?(a.Zb(!0),hy(a,"waffle-assistant-card-checkbox-disabled")):(a.Kc("waffle-assistant-card-checkbox-disabled"),a.Zb(!1));a=this.O[0];ZKc(this.D,a.rect.top,a.rect.left)};p.n_b=function(){!this.isChecked()&&PDf(this)?($_.prototype.RJ.call(this),hy(this.C,"waffle-assistant-card-checkbox-disabled")):this.isChecked()&&!PDf(this)&&($_.prototype.RJ.call(this),this.C.Kc("waffle-assistant-card-checkbox-disabled"))};p.pB=ba();p.AH=ba();
function PDf(a){return(a=a.bb("jfk-textinput"))?a.value:null}p.getColumnType=g("xa");function QDf(a,b,c,d,e,f){$_.call(this,a,c,[d],f);this.xa=e;this.Ba=b}u(QDf,$_);p=QDf.prototype;p.Ca=function(){var a=RDf(this.xa.getType()),b=tN(a0(this).rect),c=Sx(HAf,{column:oN(a0(this).rect.left),Y_:a.toLocaleUpperCase()});this.jb(c);c={};this.V=(c.recommendationCategory="COLUMN_TYPE",c.recommendationRange=b,c.recommendationType=a.toLocaleUpperCase(),c)};p.a5=m("column-type");
function RDf(a){switch(a){case 1:return"Kokonaisluku";case 2:return"Numero";case 3:return"Valuutta";case 4:return"Prosentti";case 5:return"P\u00e4iv\u00e4m\u00e4\u00e4r\u00e4";case 6:return"Aika";case 7:return"P\u00e4iv\u00e4m\u00e4\u00e4r\u00e4 ja aika";case 8:return"Teksti";case 9:return"S\u00e4hk\u00f6posti";case 11:return"Sijainti";case 12:return"Osoite";case 13:return"Puhelinnumero";case 14:return"Yritys";case 15:return"Kuuluisat ihmiset";case 16:return"Arkisto";default:return"Tuntematon"}}
p.yD=function(){$_.prototype.yD.call(this);this.D.gC(a0(this).rect.left)};p.AH=function(){var a=new Mk,b=a0(this),c=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(b.C,b.rect.top,b.rect.left,b.rect.height+b.rect.top,b.rect.left+1,12,!1),d=[];if(c){c=ia(c);for(var e=c.next();!e.done;e=c.next())(e=ritz_api.RitzModelApi.getWorkbookRangeById(e.value,!1))&&d.push(e)}this.H=ritz_api.GridViewApi.previewRangeWithColumnType(this.D.O.F,this.Ba,ln(kn(b)),this.Pa,a.serialize(this.xa),d);iQ(this.D,[b.rect])};
p.pB=function(){this.H&&(ritz_api.GridViewApi.clearTransform(this.D.O.F,this.H),this.H=null,this.D.isDisposed()||iQ(this.D,[a0(this).rect]))};function SDf(a,b,c,d,e){$_.call(this,a,b,[c],e);this.Ba=D(d,1);this.Ea=D(d,4);this.xa=d.getPattern();this.Ha=D(d,5)}u(SDf,$_);p=SDf.prototype;p.a5=m("number-format");
p.Ca=function(){var a=TDf(this.Ba),b=TDf(this.Ea);if("Tuntematon"===b)switch(this.Ba){case 3:case 4:case 8:b="Numero"}var c=tN(a0(this).rect);b=Sx(GAf,{If:c,Q0b:a.toLocaleUpperCase(),V0b:b.toLocaleUpperCase(),P0b:this.xa,J0b:this.Ha});this.jb(b);b={};this.V=(b.recommendationCategory="NUMBER_FORMAT",b.recommendationRange=c,b.recommendationType=a.toLocaleUpperCase(),b.recommendationPattern=this.xa,b)};
function TDf(a){switch(a){case 1:return"Teksti";case 2:return"Numero";case 3:return"Prosentti";case 4:return"Valuutta";case 5:return"P\u00e4iv\u00e4m\u00e4\u00e4r\u00e4";case 6:return"Aika";case 7:return"P\u00e4iv\u00e4m\u00e4\u00e4r\u00e4 ja aika";case 8:return"Tieteellinen";default:return"Tuntematon"}}p.yD=function(){$_.prototype.yD.call(this);this.D.gC(a0(this).rect.left)};
p.AH=function(){this.H=ritz_api.GridViewApi.previewRangeWithNf(this.D.O.F,ln(kn(a0(this))),this.Pa,this.Ba,this.xa);iQ(this.D,[a0(this).rect])};p.pB=function(){this.H&&(ritz_api.GridViewApi.clearTransform(this.D.O.F,this.H),this.H=null,this.D.isDisposed()||iQ(this.D,[a0(this).rect]))};function UDf(a){var b=new ug;b.setPattern(a.xa);b.setType(a.Ba);return b}
function b0(a,b,c,d){Q.call(this,d);this.L=a;this.C=b;a=ia(b);for(b=a.next();!b.done;b=a.next())this.va(b.value);this.J=c;this.H=new Q(d);this.Ga(this.H);this.D=new Oz;this.Ga(this.D);this.F=new Oz;this.Ga(this.F)}u(b0,Q);b0.prototype.Ca=function(){Q.prototype.Ca.call(this);var a=Sx(NAf,{n8a:this.J,K0b:this.C.length-3});this.jb(a);this.H.Va(this.Fa("waffle-inline-assistant-sidebar-category-cards"));for(a=0;a<this.C.length&&3>a;a++)this.H.Ga(this.C[a],!0)};
b0.prototype.Ia=function(){Q.prototype.Ia.call(this);this.D.Va(this.Fa("waffle-inline-assistant-sidebar-category-show-more-button"));this.F.Va(this.Fa("waffle-inline-assistant-sidebar-category-check-all"));if(1>=this.C.length||"anomaly"===this.L)this.F.Na(!1),this.F.setVisible(!1);this.getHandler().listen(this.F,"action",this.R);3>=this.C.length?(this.D.Na(!1),this.D.setVisible(!1)):this.getHandler().listen(this.D,"action",this.O)};
b0.prototype.R=function(){for(var a=this.C.every(function(d){return d.isChecked()})?!1:!0,b=ia(this.C),c=b.next();!c.done;c=b.next())c.value.Zb(a)};b0.prototype.O=function(){for(var a=3;a<this.C.length;a++)this.H.Ga(this.C[a],!0);this.D.Na(!1);this.D.setVisible(!1)};
function VDf(a,b,c,d,e){$_.call(this,a,b,[c],e);this.Ba=jg(d,5);this.xa=jg(d,6);this.Qa=D(d,2);this.Ka=D(d,3);this.Ta=D(d,4);this.Ea=new PW(b,"waffle-assistant-highlight-styled-border-red","waffle-assistant-highlight-styled-rect-red");this.va(this.Ea);this.Ha=new PW(b,"waffle-assistant-mouseover-highlight-styled-border-red","waffle-assistant-mouseover-highlight-styled-rect-red");this.va(this.Ha)}u(VDf,$_);p=VDf.prototype;p.a5=m("remove-duplicates");
p.Ca=function(){var a=tN(a0(this).rect),b=Sx(MAf,{JXa:this.Ba,IXa:this.xa});this.jb(b);b={};this.V=(b.recommendationCategory="REMOVE_DUPLICATES",b.recommendationRange=a,b.recommendationFirstRow=(this.Ba[0]+1).toString(),b)};p.RJ=function(){this.J=!this.isChecked();this.C.Zb(this.isChecked());this.pB();this.isChecked()?(hy(this.C,"waffle-assistant-card-unchecked-hovered-checkbox"),this.AH(),this.R||WDf(this)):(zW(this.L),zW(this.Ea));this.dispatchEvent("waffle-assistant-card-checked")};
p.yD=function(){NDf(this,!0);zW(this.L);zW(this.Ea);RW(this.ma,XDf(this));RW(this.Ha,YDf(this));this.pB();this.AH();this.C.Zb(!0);this.isChecked()||this.C.Kc("waffle-assistant-card-unchecked-hovered-checkbox");this.D.TI(this.xa[0])};p.xUa=function(){NDf(this,!1);this.isChecked()?WDf(this):(this.C.Zb(!1),this.pB());hy(this.C,"waffle-assistant-card-unchecked-hovered-checkbox");zW(this.ma);zW(this.Ha);this.La().blur()};function WDf(a){RW(a.L,XDf(a));RW(a.Ea,YDf(a))}
function XDf(a){return a.Ba.map(function(b){return new Mm(a0(a).C,new um(b,a.Qa,b+1,a.Ka))})}function YDf(a){return a.xa.map(function(b){return new Mm(a0(a).C,new um(b,a.Qa,b+1,a.Ka))})}p.AH=function(){iQ(this.D,[a0(this).rect])};p.pB=ba();function ZDf(a,b,c,d,e){$_.call(this,a,b,[c],e);this.Qa=jg(d,1);this.Ha=jg(d,2);this.Ba=Uc(this.Qa,function(f,h){return f+h},0);this.Ea=Uc(this.Ha,function(f,h){return f&&h},!0);this.xa=D(d,3);this.Ka=D(d,4)}u(ZDf,$_);p=ZDf.prototype;p.a5=m("trim-whitespace");
p.Ca=function(){var a=tN(a0(this).rect),b=Sx(IAf,{If:a,O0b:this.Ba,N6a:this.Ea,bKb:this.xa,G0b:this.Ka});this.jb(b);b={};this.V=(b.recommendationCategory="TRIM_WHITESPACE",b.recommendationRange=a,b.recommendationNumWhitespaces=this.Ba.toString(),b)};p.yD=function(){$_.prototype.yD.call(this);this.xa?this.D.gC(a0(this).rect.left):ZKc(this.D,a0(this).rect.top,a0(this).rect.left)};
p.AH=function(){this.isChecked()?this.H=ritz_api.GridViewApi.previewRangeWithApplyTrimWhitespace(this.D.O.F,ln(kn(a0(this)))):this.H=ritz_api.GridViewApi.previewRangeWithHighlightTrimWhitespace(this.D.O.F,ln(kn(a0(this))));iQ(this.D,[a0(this).rect])};p.pB=function(){this.H&&(ritz_api.GridViewApi.clearTransform(this.D.O.F,this.H),this.D.isDisposed()||(this.H=null,this.R?this.AH():iQ(this.D,[a0(this).rect])))};
function $Df(a,b,c,d,e){Q.call(this,e);this.xa=a;this.L=b;this.R=c;this.D=this.H=this.J=this.F=this.C=null;this.V=[];a=d?Ic(z(),"docs-idu")?"https://google.qualtrics.com/jfe/form/SV_a9qME1WDqLNJfMN":"https://google.qualtrics.com/jfe/form/SV_8hQyq5nzP5Ruq1L":"https://google.qualtrics.com/jfe/form/SV_4IttoTUHuK1ffw1";this.O=Sx(KAf,{link:a});this.ma=Sx(LAf)}u($Df,Q);$Df.prototype.Ca=function(){Q.prototype.Ca.call(this);ex(this.getElement(),"waffle-inline-assistant-sidebar-section")};
$Df.prototype.Ia=function(){Q.prototype.Ia.call(this);var a=this.O.getElementsByClassName("waffle-inline-assistant-sidebar-survey-link")[0];this.getHandler().listen(this.O,"click",this.Ba).listen(a,"click",function(b){b.stopPropagation()})};$Df.prototype.Ba=function(){this.Fa("waffle-inline-assistant-sidebar-survey-link").click()};
function aEf(a,b,c){a.D&&(a.removeChild(a.D,!0),a.D.dispose());if(c.length){var d=XK(a.L);if(d){var e=d.Sa();d=[];for(var f={},h=0;h<b.length;h++){var k=b[h],l=c[h],n=k.rect;n=e.Kg(n.top,n.left).getRawValue(e.dc(),n.top,n.left);var q=l+n,r=q in f?f[q].SCa:[];r.push(k);f[q]={Y_:l,r8a:n,SCa:r}}for(var w in f)b=f[w],b=new ODf(a.R,a.L,b.SCa,b.Y_,b.r8a),d.push(b);d.sort(function(x,B){x=MDf(x)[0];B=MDf(B)[0];return x.left!=B.left?x.left-B.left:x.top-B.top});a.D=new b0("anomaly",d,"Virheellinen data");a.Ga(a.D)}}}
function bEf(a,b){if(!(0>=b)){b=a.Hb();var c=a.qa().Ca("DIV",["waffle-inline-assistant-sidebar-divider"]);b.appendChild(c);a.V.push(c)}}function cEf(a){var b=a.Hb();If(a.od(!0));b.contains(a.O)&&Hf(b.removeChild(a.O));b.contains(a.ma)&&Hf(b.removeChild(a.ma));for(var c=ia(a.V),d=c.next();!d.done;d=c.next())Hf(b.removeChild(d.value));a.V=[];a.C=null;a.D=null;a.H=null;a.F=null;a.J=null}function dEf(a){return(a.C?a.C.C:[]).concat(a.D?a.D.C:[],a.H?a.H.C:[],a.F?a.F.C:[],a.J?a.J.C:[])}
function eEf(a,b,c){b=c||b;a=a||{};c='<div class="'+T("waffle-inline-assistant-sidebar-container")+'"><div class="'+T("waffle-inline-assistant-sidebar-empty-container")+'"><div class="'+T("waffle-inline-assistant-sidebar-empty-message")+'">';c=c+'Ehdotuksia ei ole saatavilla</div></div><div class="'+(T("waffle-inline-assistant-sidebar-accepted-container")+'">'+R(KAf({link:"https://google.qualtrics.com/jfe/form/SV_4IttoTUHuK1ffw1"},b))+'<div class="'+T("waffle-inline-assistant-sidebar-accepted-message")+
'">');c=c+"Datan poistoehdotuksia on k\u00e4ytetty</div>"+R(Nz({ad:"waffle-inline-assistant-sidebar-accept-back",content:"Takaisin",style:2},b));c+="</div></div>";var d=""+R(Nz({ad:"waffle-inline-assistant-sidebar-accept",content:"Hyv\u00e4ksy valitut",style:2},b));a=""+R(fY(xw({title:"Datan poisto",Ek:Aw(c),le:!0,id:"inlineassistant",Zv:"waffle-inline-assistant-sidebar",kE:Aw('<img class="docs-icon docs-auto-fix" aria-hidden="true" src="https://www.gstatic.com/images/icons/material/system/1x/auto_fix_black_24dp.png"/>'),
uU:Aw(d),kU:!0},a),b));return S(a)}function fEf(a,b,c,d,e,f){IX.call(this,f);this.L=d;this.D=new $Df(a,b,c,e,f);this.Ga(this.D);this.J=yB(new xB);this.va(this.J);this.F=new Oz(void 0);this.Ga(this.F);this.H=new Oz(void 0);this.Ga(this.H);Jz(this.J,this.H,dob)}u(fEf,IX);p=fEf.prototype;
p.Ia=function(){IX.prototype.Ia.call(this);this.getHandler().listen(this.D,"waffle-assistant-card-checked",this.u_b);JX(this,!0);var a=this.Fa("waffle-inline-assistant-sidebar-empty-container");P(a,!1);a=this.Fa("waffle-inline-assistant-sidebar-accepted-container");P(a,!1);this.F.Va(this.Fa("waffle-inline-assistant-sidebar-accept"));this.H.Va(this.Fa("waffle-inline-assistant-sidebar-accept-back"))};p.Ca=function(){var a=Sx(eEf);this.jb(a);a=this.Hb();this.D.render(a)};
p.setVisible=function(a){var b={};yA(this.L,(b.he=a,b));this.isVisible()!==a&&(IX.prototype.setVisible.call(this,a),a?JX(this,!0):cEf(this.D))};p.u_b=function(){var a=dEf(this.D).some(function(b){return b.isChecked()});cob.Na(a)};
p.initialize=function(a,b,c,d,e,f,h,k,l,n,q){cob.Na(!1);JX(this,!1);var r=this.J,w=this.F;var x=new Ej;M(x,23,b.length+d.length+f.length+k.length+n.length);x=Cy(By(xy(new wy,76),x));Jz(r,w,cob,void 0,void 0,x);cEf(this.D);r=this.Fa("waffle-inline-assistant-sidebar-accepted-container");P(r,!1);r=this.Fa("waffle-inline-assistant-sidebar-empty-container");w=this.F.La();if(a&&(b.length&&c.length||0!==d.length||f.length&&h.length||k.length&&l.length||0!==n.length)){P(r,!1);P(w,!0);if(0!==d.length){if(b=
this.D,b.C&&(b.removeChild(b.C,!0),b.C.dispose()),e.length){c=[];for(r=0;r<d.length;r++)w=new QDf(b.R,a,b.L,d[r],e[r]),c.push(w);b.C=new b0("column-type",c,"Saraketyypit");b.Ga(b.C)}}else if(b.length&&c.length&&(a=this.D,a.F&&(a.removeChild(a.F,!0),a.F.dispose()),c.length)){d=[];for(e=0;e<c.length;e++)r=new SDf(a.R,a.L,b[e],c[e]),d.push(r);a.F=new b0("number-format",d,"Numeromuoto");a.Ga(a.F)}if(f.length&&h.length&&(a=this.D,a.J&&(a.removeChild(a.J,!0),a.J.dispose()),h.length)){b=[];for(c=0;c<h.length;c++)d=
new ZDf(a.R,a.L,f[c],h[c]),b.push(d);a.J=new b0("trim-whitespace",b,"Poista tyhj\u00e4t");a.Ga(a.J)}if(k.length&&l.length&&(f=this.D,f.H&&(f.removeChild(f.H,!0),f.H.dispose()),l.length)){h=[];for(a=0;a<l.length;a++)b=new VDf(f.R,f.L,k[a],l[a]),h.push(b);f.H=new b0("remove-duplicates",h,"Kopiot");f.Ga(f.H)}0!==n.length&&aEf(this.D,n,q);k=this.D;l=k.Hb();l.appendChild(k.O);!Ic(z(),"fects")&&5>=vAf(k.xa).getValue()&&l.appendChild(k.ma);n=-1;k.C&&n++;k.D&&n++;k.H&&n++;k.F&&!k.C&&n++;k.J&&n++;k.H&&(k.H.render(l),
bEf(k,n),n--);k.C&&(k.C.render(l),bEf(k,n),n--);k.D&&(k.D.render(l),bEf(k,n),n--);k.F&&!k.C&&(k.F.render(l),bEf(k,n),n--);k.J&&(k.J.render(l),bEf(k,n))}else P(r,!0),P(w,!1),cEf(this.D)};function gEf(a,b,c){SK.call(this,150);this.hb=a;this.F=b;this.C=c}u(gEf,SK);
gEf.prototype.Id=function(){for(var a=new mLb,b=0;b<this.C.length;b++){var c=this.C[b],d=this.F[b],e=new hH,f=this.hb.dc();d=jn(d,f);E(e,1,d);switch(c.H){case 32:c=c.Id();E(e,7,c);break;case 134:c=c.Id();E(e,4,c);break;case 138:c=c.Id();E(e,3,c);break;case 1:c=c.Id();E(e,2,c);break;case 151:c=c.Id();E(e,6,c);break;case 55:c=c.Id();E(e,5,c);break;default:continue}fg(a,1,e)}return a};gEf.prototype.wg=m(!1);function hEf(a,b,c,d,e){UW.call(this,a,c);this.C=a;this.J=b;this.H=d;this.D=e;this.F=null}
u(hEf,UW);p=hEf.prototype;p.initialize=function(a,b,c,d,e,f,h,k,l,n,q){this.F=a;this.C.initialize(a,b,c,d,e,f,h,k,l,n,q)};p.show=function(){VW(this);this.C.setVisible(!0)};p.UJ=function(){var a=new Ej;M(a,23,dEf(this.C.D).length);this.D.C(36588,Cy(By(xy(new wy,76),a)));a=ia(dEf(this.C.D));for(var b=a.next();!b.done;b=a.next())this.D.C(36583,iEf(b.value));UW.prototype.UJ.call(this)};p.isVisible=function(){return this.Pf().isVisible()};p.Pf=function(){return Znb};p.Ip=function(){return $nb};
function iEf(a){var b=new Ej;if(a instanceof SDf){M(b,21,1);var c=UDf(a).getPattern();M(b,22,c);M(b,24,a.Ea)}else a instanceof ZDf?M(b,21,2):a instanceof ODf?(M(b,21,3),c=new RV,a=jEf(a.getColumnType()),M(c,2,a),cj(b,26,c)):a instanceof VDf?M(b,21,4):a instanceof QDf&&(M(b,21,5),c=new RV,a=a.xa.getType(),M(c,2,a),cj(b,26,c));return Cy(By(xy(new wy,76),b))}function kEf(a){return dEf(a.C.D).map(function(b){return b.isChecked()})}
function jEf(a){switch(a.toUpperCase()){case "LOCATION":return 11;case "ADDRESS":return 12;case "PHONE NUMBER":return 13;case "COMPANY":return 14;case "FAMOUS PEOPLE":return 15;case "STOCK":return 16;case "DATETIME":return 7;case "EMAIL ADDRESS":return 9;default:return 0}}
function lEf(a,b,c,d,e,f,h,k,l,n,q,r,w){A.call(this);this.D=a;this.O=b;this.Ha=c;this.Ya=d;this.fc=e;this.Za=h;this.Bb=k;this.ma=f;cmc(this.ma,this.D,this.fc,this.Ya);this.Pb=l;this.Cb=n;this.Dc=q;this.Kb=r;this.tc=w;this.F=null;this.R=[];this.C=new pDf(null!=this.J);this.Ba=this.Ta=this.Oa=this.Ea=!1;this.J=null;this.Wa=this.Qa=!1;this.H=oW(this.O);this.Ka=new Map;this.V=new Qp(this.gea,void 0,this);this.va(this.V);this.L=null;this.$a=new Xn(this);this.va(this.$a);this.xa=new tDf(a,b,c,this.Ka,this.C,
this.R,100,.95);this.Pa=0;this.$a.listen(this.O,"selectionChange",this.s_b).listen(this.O,"Kc",this.p_b,!0).listen(this.ma,"recommender-calc-ended",this.Z4).listen(this.ma,"recommender-calc-failed",this.Cmb).listen(TH(this.D.C),"mb",this.vBb).listen(this.D.C,"ga",this.t_b).listen(TH(this.D.C),"ac",this.Qwb).listen(this.O,"inputBoxActivate",this.o_b).listen(this.O,"inputBoxDeactivate",this.q_b).listen(TH(this.D.C),["pb"],this.uMa).listen(TH(this.D.C),["qb"],this.uMa).listen(this.Kb.Oa,"sheet-imported",
this.r_b);this.fb=new Fz(this);this.va(this.fb);this.fb.Nb(zC,zs,this.ywb).Nb(gob,zs,this.Dra).Nb(fob,zs,this.sAb).Nb(cob,zs,this.skb).Nb(dob,zs,this.$lb);mEf(this)}u(lEf,A);function mEf(a){Ic(z(),"fedpsoi")&&a.tc&&(a.L=500,a.V.start(a.L),a.Ta=!0)}function nEf(a,b){return a.H?b.filter(function(c){c=mn(mW(c));return c.C!=a.H?!1:EN(a.D,c.C||a.H,c.rect,!1)}):[]}function oEf(a){Hf(a.J);a.J=null}p=lEf.prototype;
p.r_b=function(a){a=a.kh;if(zJ(this.D.C,a)){var b=new pDf(!1);this.Ka.set(a,b);a===this.H&&(this.C=b)}this.Ba=!0;mEf(this)};p.sAb=function(){oEf(this);var a=qB(this.Dc,"N\u00e4et ehdotukset my\u00f6s yl\u00e4palkin valikosta Data -> Poistoehdotukset.",this.O.qa());a.render();a.setVisible(!0);pEf(this)};p.ywb=function(){this.Ea=!0;this.gea();qEf(this);pEf(this)};p.$lb=function(){this.Oa=!0;JX(this.F.C,!0);this.gea();pEf(this)};
function qEf(a){if(AN(a.D)){uDf(a.xa,a.R);if(!a.F){var b=new fEf(a.D.F,a.O,a.D.L.C,a.Bb,rEf());a.va(b);b.render();a.F=new hEf(b,a.D,a.Pb,a.Cb,a.Ha);a.va(a.F)}a.F.show()}}
p.skb=function(){var a=this.F,b=AN(a.J);if(b){for(var c=[],d=[],e=!1,f=ia(dEf(a.C.D)),h=f.next();!h.done;h=f.next())if(h=h.value,h.isChecked()){var k=MDf(h);switch(h.a5()){case "number-format":c.push(new aMd(b,k[0],UDf(h)));break;case "column-type":e=new Dg;var l=k[0],n=l.yc();E(e,1,n);l=l.Xc();E(e,2,l);c.push(new lKd(b,[e],h.xa));e=!0;break;case "trim-whitespace":c.push(new bMd);break;case "remove-duplicates":l=h;n=k[0];var q=new Dg,r=n.yc();E(q,1,r);r=n.Xc();E(q,2,r);c.push(new MWe(b,n,[q],l.Ta,
l.Ba.concat(l.xa)));break;case "anomaly":if(l=PDf(h))for(n=ia(k),q=n.next();!q.done;q=n.next())q=q.value,c.push(new usd(b,new bm(q.left,q.top),l));else continue}d.push.apply(d,ja(k));a.D.C(36577,iEf(h))}else a.D.C(36578,iEf(h));e&&(d.push(pn(JT(a.F.getTableRange()))),f=mn(JT(ritz_api.TablesApi.getDataRange(a.F))).rect.top,c.push(new CAd(b.dc(),"r",f)));0<c.length&&a.H.C(new gEf(b,d,c));a=a.C;cEf(a.D);b=a.Fa("waffle-inline-assistant-sidebar-accepted-container");P(b,!0);P(a.F.La(),!1)}this.C.D=null;
this.C.H=null;this.R=[]};p.o_b=function(){this.Qa=!0;this.V.stop()};p.q_b=function(){this.Qa=!1;this.L=null!=this.J?1E3:5E3;this.V.start(this.L)};
p.Dra=function(){this.Ta=this.Oa=this.Ea=!1;oEf(this);pEf(this);var a=AN(this.D);if(a){var b=[];if(this.C.D&&(b=nEf(this,this.C.D.C),!this.H))return;var c=this.C.getTableRange();if(c)var d=kDf(a,c.rect);else(d=kDf(a,a.F))&&(c=mn(JT(d.getTableRange())));var e=[],f=[],h=[],k=[],l=[],n=[],q=[];b=ia(b);for(var r=b.next();!r.done;r=b.next()){var w=r.value;r=mn(mW(w));this.R.push(r);switch(D(w,1)){case 7:var x=r.rect.left;if(ritz_api.RitzModelApi.getColumnType(a.dc(),x))continue;w=D(w,14);x=D(w,1);var B=
w.getPattern();B=iDf(this.D.F,x,B);w.setPattern(B);k.push(w);e.push(r);q[r.rect.left-c.rect.left]=w;break;case 8:w=D(w,15);l.push(w);f.push(r);break;case 9:w=D(w,16),n.push(w),h.push(r)}}qEf(this);a=[];b=[];if(c=wDf(this.xa,q,d,c))a=c.a9a,b=c.$8a;this.F&&(c=vAf(this.D.F),c.setValue(c.getValue()+1),this.F.initialize(d,e,k,b,a,f,l,h,n,this.C.C,this.C.F));c=this.C;c.Pa=d;c.V=e;c.Qa=k;c.Ha=b;c.Ea=a;c.xa=f;c.Wa=l;c.ma=h;c.Ta=n}};
p.t_b=function(){var a=oW(this.O);if(a&&this.H){this.C.R=null!=this.J;var b=null!=this.F&&this.F.isVisible();this.C.Ka=b;this.F&&(b=kEf(this.F),this.C.Ba=b,b=this.F,b.Pf().isVisible()&&b.UJ());this.Ka.set(this.H,this.C);null!=this.J&&this.Ha.C(36590);oEf(this);this.R=[];this.Ba||(this.V&&this.V.stop(),this.L=null);this.H=a;this.C=this.Ka.has(a)?this.Ka.get(a):new pDf(!1);a=this.xa;b=this.H;var c=this.C,d=this.R;b&&c&&a.D&&(a.D=b,a.C=c,uDf(a,d));if(this.C.R){if(a=XK(this.O))b=this.C.D?this.C.D.C:[],
this.J=CAf(a,this.O,this.Za,this.C.getTableRange(),b,this.C.C.length)}else if(this.C.Ka){a=this.C.Pa;b=this.C.V;c=this.C.Ha;d=this.C.xa;var e=this.C.ma,f=this.C.C;if(a&&(b.length||c.length||d.length||e.length||f.length)&&(qEf(this),this.F&&(this.F.initialize(a,b,this.C.Qa,c,this.C.Ea,d,this.C.Wa,e,this.C.Ta,this.C.C,this.C.F),a=this.C.Ba,b=dEf(this.F.C.D),b.length==a.length)))for(c=0;c<b.length;c++)b[c].Zb(a[c])}}};
p.uMa=function(){if(Ic(z(),"fecad")){var a=this.xa,b=this.R;a.C.C=[];a.C.F=[];a.C.J=[];var c=a.C;c.O=[];c.L=[];uDf(a,b)}};
p.vBb=function(a){if(a.C){var b=AN(this.D);if(!b)if(a.target instanceof lK)b=a.target;else return;var c=b.F;a.C.some(function(e){return c.intersects(e)&&20<=e.height&&4<=e.width&&100<=e.height*e.width})?(this.Wa=!0,this.V.start(500)):!this.Wa&&this.V.Xb()&&(this.L=null!=this.J?1E3:5E3,this.V.start(this.L));DDf(this.xa,b,a.C);b={};a=ia(a.C);for(var d=a.next();!d.done;b={n7:b.n7},d=a.next()){b.n7=d.value;if(!this.H)break;if(!this.C.H)break;if(gxa(this.C.H,b.n7)&&(!this.R||null!=this.J||!this.R.some(function(e){return function(f){return e.n7.equals(f.rect)}}(b)))){this.C.H=
null;this.R=[];null!=this.J?(this.L=1E3,this.V.start(this.L)):this.C.D=null;break}}}};p.s_b=function(){DN(this.D)&&!Ic(z(),"fedpsoi")&&(this.L=this.L||500,this.V.start(this.L))};p.p_b=function(){var a=AN(this.D);if(a){var b=sK(a).x;EDf(this.xa,a,new um(0,b,a.gg(),b+1,!1,!0));this.C.H=null;this.R=[];null!=this.J?(this.L=1E3,this.V.start(this.L)):this.C.D=null}};p.Cmb=function(){2<this.Pa?(this.Pa=0,this.Z4(null)):(this.Pa++,this.gea())};
p.Z4=function(a){this.Ba=!1;this.Pa=0;this.Wa=!1;if((Ic(z(),"fenfts")||Ic(z(),"fetws")||Ic(z(),"ferds")||Ic(z(),"fecad"))&&!this.Qa){var b=this.ma.C,c=XK(this.O);if(this.H)if(a&&c&&b&&this.H&&b.C===this.H?(this.C.D=a,this.C.H=b.rect):(this.C.D=null,this.C.H=null),this.C.Oa=b,this.Ea||this.Oa)this.Dra();else{a=a?nEf(this,a.C):[];var d=this.C.C.length,e=a.length+d;if(!b||2>e)sEf(this);else if(!this.F||!this.F.isVisible()){for(var f=!1,h=0,k=0,l=ia(a),n=l.next();!n.done;n=l.next())n=n.value,7==D(n,1)?
(f=f||D(D(n,14),3),h++):9==D(n,1)&&(f=!0,k++);f?0==k&&2>h?sEf(this):(null!=this.J?(c=this.J,c.J=b,zAf(c,a),c.H=d,b=tN(c.J.rect),b=Ic(z(),"feadpdp")?Sx(wAf,{If:b,Efa:c.D,Hfa:c.F,Ffa:c.C,Cfa:c.H}):Sx(xAf,{If:b,cVa:c.D+c.F+c.C+c.H}),a=c.Fa("waffle-assistant-popup-suggestion-text-container"),c.qa().od(a),c.qa().appendChild(a,b)):this.Ta?(this.Ha.C(36702,tEf(this,e)),this.Dra()):rEf()||Ic(z(),"fedpsoi")||(this.Ha.C(36324,tEf(this,e)),this.J=CAf(c,this.O,this.Za,b,a,d)),this.C.R=null!=this.J):sEf(this)}}}};
function sEf(a){null!=a.J&&(a.Ha.C(36589),oEf(a))}function tEf(a,b){var c=new Ej;M(c,23,b);for(var d in KDf){b=new QV;switch(KDf[d]){case "number-format":M(b,1,1);M(b,2,a.C.V.length);break;case "trim-whitespace":M(b,1,2);M(b,2,a.C.xa.length);break;case "remove-duplicates":M(b,1,4);M(b,2,a.C.ma.length);break;case "anomaly":M(b,1,3);M(b,2,a.C.C.length);break;case "column-type":M(b,1,5);M(b,2,a.C.L.length);break;default:continue}fj(c,25,b,QV,void 0)}return Cy(By(xy(new wy,76),c))}
function pEf(a){a.H&&uAf(a.D.F.L,a.D.D.F,a.H)}p.Qwb=function(a){xDf(this.xa,this.R,a)};
p.gea=function(){if(this.H){if(!this.Ba&&!this.Ea&&!this.Oa){var a=this.D.F.L;if(!Ui(a.C,2,!0))return;var b=this.D.D.F;a=ia(bj(a.C,YV,1));for(var c=a.next();!c.done;c=a.next())if(c=c.value,b===K(c,1)&&this.H===c.ib())return}this.L=null;b=AN(this.D);a=ZK(this.O);b&&!this.D.Ld()&&this.D.H.C&&!GN(this.D)&&a&&!a.F?(a=b.F,(c=this.C.H)&&gxa(c,a)?((this.Ea||null!=this.J)&&this.Z4(this.C.D),this.Ba=!1):aBe(this.ma)?(this.ma.reset(),mHe(this.ma),(b=kDf(b,a))?(b=FAf(b.getTableRange()),this.ma.O=b,wHe(this.ma,
!0,!0,!1,[7,8,9])):this.Z4(null)):this.Z4(null)):this.Ba=!1}};function rEf(){return"MERGED"===Lc(z(),"fdpfs")&&Ic(z(),"fects")&&Ic(z(),"fecis")&&Ic(z(),"fecad")}
function uEf(a,b,c,d,e,f,h,k,l,n,q){UW.call(this,b,h);var r=this;this.H=a;this.C=b;this.Ea=c;this.Pa=d;this.Ka=e;this.L=f;this.D=c.C;this.Ha=this.Ba=!1;this.F=null;this.V=k;this.Qa=q;this.J=null;vEf(this);pob.Na(!0);a=new tj;M(a,6,wEf());b=new qj;uj(b,a);this.ma=Cy(xy(yy(new wy,b),10));this.xa=-1;a=new Qp(function(){return xEf(r,!1)},100);this.va(a);a.start()}u(uEf,UW);
function vEf(a){var b=TH(a.Ka);a.Ma.listen(a.Pa,"selectionChange",a.xRb).listen(a.D,"ga",a.wRb).listen(a.D,"qa",a.zRb).listen(b,"mb",a.MMa).listen(a.C,"vd",a.Blb).listen(a.C,"ud",a.Alb).listen(a.C,"td",a.ylb).listen(a.C,"Bd",a.GBb).listen(a.C,"xd",a.Wmb).listen(a.C,"Fd",a.TEb).listen(a.C,"Cd",a.mDb).listen(a.C,"wd",a.Zlb).listen(a.C,"Gd",a.ARb).listen(a.H.C,"recommender-confidence-update",a.yob).listen(a.C,"Dd",a.yRb);Ns(Ns(Ns(Ns(Ns(Ns(Ms(a.O,GC,(Cs(),Ds),function(){a.C.Qea(!GC.isEnabled())}),HC,
function(){var c=a.C.isVisible();a.Pf().setVisible(!c);c||a.C.focus();yEf(a,!c)}),qob,function(c){LCf(a.C,c.data)}),Snb,function(){return zEf(a)}),wD,function(c){return AEf(a,c.data)}),Vvb,function(){hDf(a.C,!0)}),pE,function(){return a.UJ()})}p=uEf.prototype;p.Pf=function(){return rob};p.Ip=function(){return sob};p.lx=function(a){UW.prototype.lx.call(this,a);qob.Na(a);xEf(this,!1);!this.Ba&&a&&(this.Ba=!0);var b={};yA(this.Qa,(b.ie=a,b));a||this.C.Pc()};
p.y4=function(a){var b=this;this.C.Ixa();var c=new Qp(function(){UW.prototype.y4.call(b,a)},300);this.va(c);c.start()};p.UJ=function(){UW.prototype.UJ.call(this);yEf(this,!1)};p.CSa=function(a){this.C.DSa(a);this.H.C.Ka=a};p.Blb=function(a){var b=a.C.H,c=D(D(b,13),3);b=mW(b);var d=new Rg;YDd(d,c);var e=new wq;E(e,1,d);E(e,3,!0);wEe(e,!0);this.L.C(new RWe(e,b));c0(this,a.Mj(),!1,lWe(Pg(c)))};function yEf(a,b){b?(c0(a,2253),a.xa=La()):c0(a,2226,!0)}function zEf(a){a.C.isVisible()||a.lx(!0)}
function AEf(a,b){var c="",d=void 0;b&&b.evt&&(c=b.evt?b.evt.C:"",d=b.evt);var e=fDf(a.C);e&&(e.Xb()?VBf(e,c,!0,!!c,d):(zEf(a),b=new Qp(function(){UBf(e,c,!0,!!c,d)},1E3),a.va(b),b.start()))}p.zRb=function(){ZV(this.H.C)||(this.H.C.reset(),xEf(this,!1))};p.xRb=function(){if(DN(this.Ea)&&null==this.C.O){var a=ZV(this.H.C);a&&CJ(this.D)!=a.ib()||xEf(this,!0)}};
function xEf(a,b,c){if(c){if(!c.length)return;if(1==c.length&&a.J&&c[0].equals(a.J)){a.J=null;return}}var d=a.C;d.isVisible()&&(d.Ka.refresh(void 0),NCf(d));a.H.update(!b,a.C.isVisible(),c)}
p.yob=function(a){var b=a.C,c=b?b.D:null;a=b?b.C:0;var d=!!b&&.9<=b.C,e=b?b.D.rect:null;e=!!e&&e.Wh()>=xlb&&Im(e,"r")>=zlb&&Im(e,"c")>=Alb&&e.Wh()<=ylb;b=!!b&&.6<=b.C&&e;if(b!==this.Ha||c&&!c.intersects(this.F))this.Ha=b,this.F=c,this.xa=La(),pob.wb({bda:b,EB:c});e&&c&&c.rect&&(b=1E3>=c.rect.Wh(),c=ritz_api.RitzModelApi.isFormsRegion(c.C,c.rect.top,c.rect.left,c.rect.height+c.rect.top,c.rect.width+c.rect.left),d=!this.C.isVisible()&&!this.Ba&&d&&b&&!hM(this.Ea.H),c=Ic(z(),"feeaof")&&c,b=Ic(z(),"feeaoro")&&
this.Ea.Ld(),d&&(c||b)&&(d=new tj,M(d,1,a),M(d,2,c),M(d,3,b),M(d,5,Clb),M(d,6,wEf()),a=new qj,uj(a,d),a=Cy(yy(xy(new wy,10),a)),this.qDa(a)))};p.qDa=function(a){var b=this;if(GJ(this.D)&&!AK(JJ(this.D))&&(this.C.tc=!0,!hC.vaa().C)){var c=a||this.ma;this.Pf().setVisible(!0);this.V.C(2225,c);c0(this,2253);a=new Qp(function(){b.C.isVisible()||b.V.C(2752,c)},5E3);this.va(a);a.start()}};
function wEf(){switch(Blb){case "NO_DELAY":return 1;case "DELAY_500MS":return 2;case "DELAY_1S":return 3;case "DELAY_2S":return 4;default:return 0}}p.Zlb=function(){this.C.Pc()};p.ARb=function(a){var b=a.C,c=mW(b.H);this.J=pn(c);BGd(this.L.D);fCf(b,c);c0(this,a.Mj())};p.wRb=function(){GJ(this.D)?(this.C.Na(!0),this.H.C.reset(),xEf(this,!1)):(this.Pf().setVisible(!1),this.H.C.reset(),this.C.Na(!1))};p.MMa=function(a){xEf(this,!1,PPb(a))};
p.Alb=function(a){var b=JJ(this.D),c=b.dc(),d=[],e=JWe(b);if(e){b=new Tq;var f=kg(e,2);E(b,3,f);f=kg(e,2);E(b,2,f);e=kg(e,1);E(b,1,e);d.push(b)}b=a.C.Sd;for(e=0;e<b.length;e++)f=new Tq,E(f,2,b[e]),d.push(f);this.L.C(new QWe(d,c));c0(this,a.Mj())};
p.ylb=function(a){var b=a.C,c=xWe(b.C),d=mW(b.H),e=c.Ex?c.qA:null,f=c.C?c.Tz:null,h=d.ib(),k=BEf(d);this.J=pn(d);k?(c=new TWe(k,h,this.J,e,c.Aw,c.Ax,f),TK(c,function(l){l&&a.D.call()}),this.L.C(c)):(c=new OWe(h,this.J,e,c.Aw,c.Ax,f),TK(c,function(l){l&&a.D.call()}),this.L.C(c));d=new K7d;M(d,1,1);c=new CV;iEe(c,D(b.H,2));cj(c,5,d);b=oOe(this.F,CJ(this.D));cW(b,c);b=Cy(yy(xy(new wy,10),b));this.V.C(a.Mj(),b)};
p.GBb=function(a){var b=a.C,c=mW(b.H),d=BEf(c);this.J=pn(c);d=new PWe(d);TK(d,function(e){e&&a.D.call();fCf(b,c)});this.L.C(d)};p.yRb=function(a){var b=nAe(a.getTableRange()),c=OAf(b,a.D,a.O),d=this.H,e=a.D;mHe(d.C);d.C.O=b;d.C.Ba=c;d.C.Ea=e;wHe(d.C,!0,!0,!1);c0(this,a.Mj());a.getTableRange().C!=CJ(this.D)&&(c=a.getTableRange().C,c=KJ(this.D,c))&&(c=TH(c),this.Ma.listen(c,"mb",this.MMa));a.F&&(fDf(this.C)&&fDf(this.C).DQ(!0,!1,!0),a=this.C,b=[b],a.isVisible()&&(a.Ka.refresh(b),NCf(a)))};
function BEf(a){var b=a.ib();a=pn(a);b=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(b,a.Ac(),a.yc(),a.Yc(),a.Xc(),7,!1);return 0<b.length?b[0]:null}p.Wmb=function(a){var b=a.Qa;AJ(JJ(this.D),b);c0(this,a.Mj())};
p.TEb=function(a){var b=a.C;a=a.Mj();if(b instanceof SX||b instanceof hVe||b instanceof sCf)c0(this,a,void 0,void 0,b.pJ());else{var c=MCf(this.C),d=new CV,e=D(b.H,2);c=c.indexOf(b);M(d,1,c);iEe(d,e);e=new qj;cW(e,d);if(b instanceof rBf){(d=b.D)?(b=CEf(this,b,d),b=Wrd(b,d,d.Ik)):b=null;if(!b)return;cj(e,39,b)}else if(b instanceof LBf){var f=b.H;c=new I7d;if(b instanceof LBf)b=1;else throw Error("Unknown text analysis card type.");f=jg(nW(f),20).slice(0,10);M(c,2,f||[]);M(c,1,b);cj(d,3,c)}e=Cy(yy(xy(new wy,
10),e));this.V.C(a,e)}};p.mDb=function(){this.C.Pc()};function CEf(a,b,c){a=MCf(a.C).filter(function(f){return f instanceof rBf});var d=a.map(function(f){return f.qe()}),e=a[0]&&D(a[0].J,29);return Urd(c,a.indexOf(b),b.D&&b.D.Pe(),d,e)}
function c0(a,b,c,d,e){e=void 0===e?10:e;if(a.F){var f=N(Ij(a.ma),tj,58).getTableRange();if(c||!f||f.ib()!=a.F.C||f.yc()!=a.F.rect.yc()||f.Ac()!=a.F.rect.Ac()||f.Xc()!=a.F.rect.Xc()||f.Yc()!=a.F.rect.Yc()){f=new tj;M(f,6,wEf());var h=nOe(a.F);cj(f,7,h);c&&(c=La()-a.xa,M(f,8,1E3*c),null!=a.C.Pb&&(c=La()-a.C.Pb,M(f,10,1E3*c)));d&&kEe(f,d);d=new qj;uj(d,f);a.ma=Cy(xy(yy(new wy,d),e))}}a.V.C(b,a.ma)}function DEf(){IK.apply(this,arguments)}u(DEf,IK);p=DEf.prototype;p.iib=function(){return wCf};p.Ugb=function(){return dDf};
p.Khb=function(){return lEf};p.Bhb=function(){return YAf};p.Tgb=function(){return uEf};p.Ngb=function(){return RAf};p.Dhb=function(){return $Af};NK("assistant",DEf);
